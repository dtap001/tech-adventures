<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.4">Jekyll</generator><link href="http://localhost:4000/techie-tales/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/techie-tales/" rel="alternate" type="text/html" hreflang="en" /><updated>2024-11-24T09:46:57+01:00</updated><id>http://localhost:4000/techie-tales/feed.xml</id><title type="html">Techie Tales üî•</title><subtitle>This is the blog of my noteworthy technical journeys and adventures as a developer and techlead.</subtitle><entry><title type="html">Certificates in and outs</title><link href="http://localhost:4000/techie-tales/posts/certs-in-and-outs/" rel="alternate" type="text/html" title="Certificates in and outs" /><published>2024-11-01T10:32:20+01:00</published><updated>2024-11-23T13:21:50+01:00</updated><id>http://localhost:4000/techie-tales/posts/certs-in-and-outs</id><content type="html" xml:base="http://localhost:4000/techie-tales/posts/certs-in-and-outs/"><![CDATA[<blockquote class="prompt-info">
  <p>This is my humble summary regarding every important aspect of the certificates that a developer likely will encounter. I will update this article as I learn more about this topic.
Every feedback is welcomed and appreciated üôèüèª</p>
</blockquote>

<h2 id="some-basics">Some basics</h2>

<h3 id="hashing-">Hashing ‚Äú#‚Äù</h3>

<p>Hashing is the process of transforming a character string to an another format using a mathematical function which makes it:</p>

<ul>
  <li>fast -&gt; using trapdoor functions which are easy to calculate but hard to reverse e.g.: product of two prime number but finding out which two numbers were they is much much harder</li>
  <li>theoretically unreversible</li>
  <li>provides the same output for the same input</li>
  <li>prevents collisions -&gt; cannot produce the same output for for the same input</li>
  <li>reduces the input size -&gt; it divides the input to equal blocks then compress them before running the hash function</li>
</ul>

<p>Ok, but what is it good for?</p>

<p>Usually hashes are sent along side with a payload/data to determine if it was tempered after the sender initially sent it to the client. But the are also used for authentication when the user‚Äôs password wont be stored in the database just the <strong>salt</strong>ed hash itself.</p>

<p><strong>Salting üßÇ</strong> is the process of concatenating an already known properly of the user to the password and hash it together. This is important to prevent <a href="https://www.beyondidentity.com/glossary/rainbow-table-attack">rainbow table attacks</a> for leaked databases which contains the hashes of the user passwords.</p>

<p>For example each certificate contains the hash fingerprint of itself and this way when client receives it, then it can be hashed again and see if the fingerprints are matching.</p>

<p><strong>Peppering üå∂Ô∏è</strong> is one more additional layer of security when storing hash. It is basically doing one more round of hashing but now using some shared secret which will be the same for all of the entries in the database.</p>

<h4 id="hashing-algorithms">Hashing algorithms</h4>

<p>There are multiple algorithms which is used for hashing, but they have different characteristics. Some of them lost their reliability by proving it can create collisions when we are doing lot of hashes, or simply the computers evolved so much that the hash can be reversed because it is not using big enough prime numbers or complexity.</p>

<h5 id="lets-see-which-algo-should-be-used-in-2024">Lets see which algo should be used in 2024</h5>

<table>
  <thead>
    <tr>
      <th><strong>Algorithm</strong></th>
      <th><strong>Suggested in 2024</strong></th>
      <th><strong>Digest Size</strong></th>
      <th><strong>Speed</strong></th>
      <th><strong>Security Level</strong></th>
      <th><strong>Typical Applications</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>MD5</strong></td>
      <td>‚ùå No</td>
      <td>128 bits</td>
      <td>Very Fast</td>
      <td>Weak (prone to collisions)</td>
      <td>Checksums, basic data integrity</td>
    </tr>
    <tr>
      <td><strong>SHA-1</strong></td>
      <td>‚ùå No</td>
      <td>160 bits</td>
      <td>Fast</td>
      <td>Weak (collisions found)</td>
      <td>Legacy systems, data integrity</td>
    </tr>
    <tr>
      <td><strong>SHA-2 (SHA-256)</strong></td>
      <td>‚úÖ Yes</td>
      <td>256 bits</td>
      <td>Moderate</td>
      <td>Strong</td>
      <td>Cryptographic protocols, blockchain, SSL</td>
    </tr>
    <tr>
      <td><strong>SHA-2 (SHA-512)</strong></td>
      <td>‚úÖ Yes</td>
      <td>512 bits</td>
      <td>Slower</td>
      <td>Very Strong</td>
      <td>High-security applications, SSL</td>
    </tr>
    <tr>
      <td><strong>SHA-3 (SHA3-256)</strong></td>
      <td>‚úÖ Yes</td>
      <td>256 bits</td>
      <td>Moderate</td>
      <td>Very Strong</td>
      <td>Cryptographic protocols, secure storage</td>
    </tr>
    <tr>
      <td><strong>SHA-3 (SHA3-512)</strong></td>
      <td>‚úÖ Yes</td>
      <td>512 bits</td>
      <td>Slower</td>
      <td>Very Strong</td>
      <td>High-security applications</td>
    </tr>
    <tr>
      <td><strong>BLAKE2</strong></td>
      <td>‚úÖ Yes</td>
      <td>Variable (up to 512 bits)</td>
      <td>Very Fast</td>
      <td>Strong</td>
      <td>General purpose, cryptography, file hashing</td>
    </tr>
    <tr>
      <td><strong>BLAKE3</strong></td>
      <td>‚úÖ Yes</td>
      <td>256 bits</td>
      <td>Very Fast</td>
      <td>Strong</td>
      <td>File hashing, cryptography, real-time systems</td>
    </tr>
    <tr>
      <td><strong>RIPEMD-160</strong></td>
      <td>‚ö†Ô∏è Limited use</td>
      <td>160 bits</td>
      <td>Moderate</td>
      <td>Moderate</td>
      <td>Digital signatures, blockchain</td>
    </tr>
    <tr>
      <td><strong>Whirlpool</strong></td>
      <td>‚úÖ Yes</td>
      <td>512 bits</td>
      <td>Slow</td>
      <td>Very Strong</td>
      <td>High-security storage, cryptographic protocols</td>
    </tr>
    <tr>
      <td><strong>Tiger</strong></td>
      <td>‚ö†Ô∏è Limited use</td>
      <td>192 bits</td>
      <td>Fast</td>
      <td>Moderate</td>
      <td>Data integrity verification</td>
    </tr>
    <tr>
      <td><strong>Argon2</strong></td>
      <td>‚úÖ Yes</td>
      <td>Variable</td>
      <td>Slow (memory-intensive)</td>
      <td>Very Strong</td>
      <td>Password hashing</td>
    </tr>
    <tr>
      <td><strong>PBKDF2</strong></td>
      <td>‚úÖ Yes</td>
      <td>Variable</td>
      <td>Slow (iteration-based)</td>
      <td>Very Strong</td>
      <td>Password hashing, key derivation</td>
    </tr>
    <tr>
      <td><strong>Scrypt</strong></td>
      <td>‚úÖ Yes</td>
      <td>Variable</td>
      <td>Slow (memory-intensive)</td>
      <td>Very Strong</td>
      <td>Password hashing, key derivation</td>
    </tr>
  </tbody>
</table>

<h4 id="hashing-best-practices-">Hashing best practices üí°</h4>

<blockquote class="prompt-warning">
  <p><strong>Never store password in the database plaintext, use a hashed and salt&amp;peppered string preferably using at least sha2 with multiple iterations/work factors. This way the
cracking process itself wont worth for the attacker.</strong></p>
</blockquote>

<hr />

<h3 id="what-is-a-certificate-">What is a certificate? üé´</h3>

<blockquote class="prompt-info">
  <p>A <strong>certificate</strong> or <strong>digital certificate</strong> is a unique, <a href="https://www.computerhope.com/jargon/d/digisig.htm">digitally signed</a> document which authoritatively identifies the identity of an individual or organization. Using <a href="https://www.computerhope.com/jargon/p/pkc.htm">public key cryptography</a>, its authenticity can be verified to ensure that the software or website you are using is legitimate. On the Internet, a certificate is signed by a trusted <a href="https://www.computerhope.com/jargon/c/certificate-authority.htm">CA</a> (certificate authority), and verified with the authority‚Äôs public key. The decrypted certificate contains a verified public key of the certificate holder (website operator), with which encrypted <a href="https://www.computerhope.com/jargon/h/http.htm#https">HTTPS</a> communications can be established.
<a href="https://www.computerhope.com/jargon/c/certific.htm">source</a></p>
</blockquote>

<p>So basically the certificate is a unique generated chain of characters in a specific format which can be validated by a third party (CA) therefore can be used for authentication/authorization and prove the integrity of the document.</p>

<h2 id="use-cases">Use cases</h2>

<p>Certificates are used for:</p>

<ul>
  <li>securing communication between two parties -&gt; like ssh or http</li>
  <li>proving access rights for a server -&gt; mutual tls (mTLS)</li>
  <li>proving integrity of a document -&gt; digitally signed pdf</li>
</ul>

<h2 id="how-to-use-certificate-to-secure-communication">How to use certificate to secure communication?</h2>
<blockquote class="prompt-info">

  <p>The smart people invented a system which relies on certificates to secure the data using <strong>public-key cryptography</strong> or in another name -&gt; <strong>Asymmetric cryptography</strong></p>
</blockquote>

<h3 id="generate-the-public-private-key-pair">Generate the public private key pair</h3>

<h4 id="algorithms-for-generation-and-key-sizes">Algorithms for generation and key sizes</h4>

<p>The certificates usually generated with one of the following algorithms in combination with one of the previously mentioned hashing algorithms.</p>

<p>Key is basically a random string of bits that serves as input for cryptographic algorithms. The stronger is the key and the encryption algorithm your data is in bigger safety.</p>

<ul>
  <li>RSA
    <ul>
      <li>using big prime numbers and based on factoring trap door function, using big keys to provide security</li>
      <li>common key size are 2048 and 4096. 2028 bit according to NIST is secure until 2030</li>
    </ul>
  </li>
  <li>ECDSA (Elliptic curve)
    <ul>
      <li>based on mathematical properties of elliptic curves from which next point can be calculated easily (public key), but reversing it almost impossible -&gt; using shorter keys due to it</li>
      <li>256 bit key size is equivalent of 3072 bit RSA key size</li>
    </ul>
  </li>
  <li>DSA -&gt; using discrete logarithmic properties and private key generated from the content that we want to sign -&gt; used for ensuring file integrity and verification</li>
</ul>

<h4 id="how-to-generate">How to generate</h4>

<p>First generate the private key</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl genpkey <span class="nt">-algorithm</span> RSA <span class="nt">-out</span> private_key.pem <span class="nt">-pkeyopt</span> rsa_keygen_bits:2048
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Generate the public key</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl rsa <span class="nt">-in</span> private_key.pem <span class="nt">-pubout</span> <span class="nt">-out</span> public_key.pem
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Raw content:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre></td><td class="rouge-code"><pre>       ‚îÇ File: private_key.pem
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
   1   ‚îÇ -----BEGIN PRIVATE KEY-----
   2   ‚îÇ MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDNSq1wtI4exogf
   3   ‚îÇ REWOvSkYUVAIva6qblvCJ1heOEyllek+RKGPQI4Iw/bgAg8UFb2GqmO6Aci8aT7r
   4   ‚îÇ e0+acZI1OFKX1pXpSJ0mQ7tLuDhCoM/LYr+1vxqHaq/T/u+8jLNds2Iw20rhfbnD
   5   ‚îÇ huJ/cYCw5N/8qdxsmph7tuvwpyDl6pAV7YpxE4RZVld7SAxQtAjoW1TSgGRFDkiu
   6   ‚îÇ DKMwGur8Y4zz+ZeJuf93gBt0/St/IGWWlh1vXGoSI60yikOZCKc8lN++kYlJ846y
   7   ‚îÇ p7G2Gqang6EKs3N90IbfCFhkwl65ZBddhUVbQD6aSl/PfN3T2plek8H3BxYAfOus
   8   ‚îÇ qpfzfA29AgMBAAECggEAAwfYsqK/vF2S8d84pahOPIEqzM48D2EMsruQ9uce3ozt
   9   ‚îÇ ghFST0KVNjTqZpkxLss5Xo0SZtMS6xEksCZEYRPPJED+Gya8VNLRGxkB4VbJYdZs
  10   ‚îÇ 6uQ8z0qQcjJVgSwwzthG55m319/M5bJM9UF/A4Gh9DqUwe6iBepsWNs09XsKJcq/
  11   ‚îÇ a4AdnVGrBN+t1dCVCK+rGglKV0mAZyIDERK5LAxDG6UoO9i1UodA8ofGg2WHRBqN
  12   ‚îÇ eDoc5/XWEjdAUaHPhgpGIpjtfHuXcKzlLlsLBVyJ5t8A/MQgAzwYbkuiL+R6QyFZ
  13   ‚îÇ Uj751bMNNstNhSQrN8PwxHOBBS43EmqRp+DiUDlPoQKBgQDq1DOgX9qyqBAqvqJ0
  14   ‚îÇ C/A3vY4ESLybUZBbqQt48H3TivRc+ZmY5Cdn+UjNAKL7lIiWCz2H9wEhZP7XWZmz
  15   ‚îÇ ZYS6NX8j1QOfseuqNJyV7EOW3ddtARdRpf6gTSCk8SSEn+gBPh748iVvHYI4+BZm
  16   ‚îÇ pMf5F3CrLaWjDUI/q0r2Ifk8kQKBgQDfzMOKsknL3DgYfyY67SEDH1ILMUxEnabi
  17   ‚îÇ z1iuvbZzrjjYIUlTpyPdAe14vrGYIjT2oYzweRYVMq5q+ugODsohc9GT2WSnxTBI
  18   ‚îÇ LhM2JC9eQ/FNGmHYt+g3K1sSK93YFiXW/ZWj8lRiP6ent1VvqQLfrZj5w6EmlBGB
  19   ‚îÇ 8q2BgjsEbQKBgFbm8rgN4QQul9UJuVrStDIcjvrc5Bdihta05075SMdJbAcgQ4xG
  20   ‚îÇ GqMqqJtc+fO6UxWb0UiIyz1Nf9W4Dd5K2mSCuatMAExP7pONZslApv6k2D05oySP
  21   ‚îÇ FnzCLit8JfSCrLwQ/itIiTvmorNsc/XGU07GMubWPK7rkDG5tUMC7ZZRAoGBANpc
  22   ‚îÇ J86D9oz56aG9LcgA5lztildxWkD4sYRLWvPkFsj4DG6Uy77bLZrN7q4JIa6WcabS
  23   ‚îÇ KXnYKzuzn4qyFQjiVUYegzYGvrcTJvDGQ+hnlfAbyqy4ORADIIfzvYAVXPchZPpH
  24   ‚îÇ omG8Z6kVArgZoTq5ZRxpfQD1Z58EibCI39GlB4BhAoGAML+iU0yUj5FZs/X8vLPx
  25   ‚îÇ ZJwuZU+7GHM1HbJXhH/BZY0poBzBNFjKj8mu5l36T4x+EZ6ySkmfJ5isEdXcKO6M
  26   ‚îÇ JFukU8YHUMWCN/YZpNg/92XNoB5PtUFj/bsEBHAu1GZzXgcjoA84rcgvLQq+4Ufb
  27   ‚îÇ 8xQKC3zQmqhkeq3GewThg48=
  28   ‚îÇ -----END PRIVATE KEY-----
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
       ‚îÇ File: public_key.pem
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
   1   ‚îÇ -----BEGIN PUBLIC KEY-----
   2   ‚îÇ MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAzUqtcLSOHsaIH0RFjr0p
   3   ‚îÇ GFFQCL2uqm5bwidYXjhMpZXpPkShj0COCMP24AIPFBW9hqpjugHIvGk+63tPmnGS
   4   ‚îÇ NThSl9aV6UidJkO7S7g4QqDPy2K/tb8ah2qv0/7vvIyzXbNiMNtK4X25w4bif3GA
   5   ‚îÇ sOTf/KncbJqYe7br8Kcg5eqQFe2KcROEWVZXe0gMULQI6FtU0oBkRQ5IrgyjMBrq
   6   ‚îÇ /GOM8/mXibn/d4AbdP0rfyBllpYdb1xqEiOtMopDmQinPJTfvpGJSfOOsqexthqm
   7   ‚îÇ p4OhCrNzfdCG3whYZMJeuWQXXYVFW0A+mkpfz3zd09qZXpPB9wcWAHzrrKqX83wN
   8   ‚îÇ vQIDAQAB
   9   ‚îÇ -----END PUBLIC KEY-----
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Dissect it with openssl:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl pkey <span class="nt">-in</span> private_key.pem <span class="nt">-text</span> <span class="nt">-noout</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
</pre></td><td class="rouge-code"><pre>Private-Key: (2048 bit, 2 primes)
modulus:
    00:cd:4a:ad:70:b4:8e:1e:c6:88:1f:44:45:8e:bd:
    29:18:51:50:08:bd:ae:aa:6e:5b:c2:27:58:5e:38:
    4c:a5:95:e9:3e:44:a1:8f:40:8e:08:c3:f6:e0:02:
    0f:14:15:bd:86:aa:63:ba:01:c8:bc:69:3e:eb:7b:
    4f:9a:71:92:35:38:52:97:d6:95:e9:48:9d:26:43:
    bb:4b:b8:38:42:a0:cf:cb:62:bf:b5:bf:1a:87:6a:
    af:d3:fe:ef:bc:8c:b3:5d:b3:62:30:db:4a:e1:7d:
    b9:c3:86:e2:7f:71:80:b0:e4:df:fc:a9:dc:6c:9a:
    98:7b:b6:eb:f0:a7:20:e5:ea:90:15:ed:8a:71:13:
    84:59:56:57:7b:48:0c:50:b4:08:e8:5b:54:d2:80:
    64:45:0e:48:ae:0c:a3:30:1a:ea:fc:63:8c:f3:f9:
    97:89:b9:ff:77:80:1b:74:fd:2b:7f:20:65:96:96:
    1d:6f:5c:6a:12:23:ad:32:8a:43:99:08:a7:3c:94:
    df:be:91:89:49:f3:8e:b2:a7:b1:b6:1a:a6:a7:83:
    a1:0a:b3:73:7d:d0:86:df:08:58:64:c2:5e:b9:64:
    17:5d:85:45:5b:40:3e:9a:4a:5f:cf:7c:dd:d3:da:
    99:5e:93:c1:f7:07:16:00:7c:eb:ac:aa:97:f3:7c:
    0d:bd
publicExponent: 65537 (0x10001)
privateExponent:
    03:07:d8:b2:a2:bf:bc:5d:92:f1:df:38:a5:a8:4e:
    3c:81:2a:cc:ce:3c:0f:61:0c:b2:bb:90:f6:e7:1e:
    de:8c:ed:82:11:52:4f:42:95:36:34:ea:66:99:31:
    2e:cb:39:5e:8d:12:66:d3:12:eb:11:24:b0:26:44:
    61:13:cf:24:40:fe:1b:26:bc:54:d2:d1:1b:19:01:
    e1:56:c9:61:d6:6c:ea:e4:3c:cf:4a:90:72:32:55:
    81:2c:30:ce:d8:46:e7:99:b7:d7:df:cc:e5:b2:4c:
    f5:41:7f:03:81:a1:f4:3a:94:c1:ee:a2:05:ea:6c:
    58:db:34:f5:7b:0a:25:ca:bf:6b:80:1d:9d:51:ab:
    04:df:ad:d5:d0:95:08:af:ab:1a:09:4a:57:49:80:
    67:22:03:11:12:b9:2c:0c:43:1b:a5:28:3b:d8:b5:
    52:87:40:f2:87:c6:83:65:87:44:1a:8d:78:3a:1c:
    e7:f5:d6:12:37:40:51:a1:cf:86:0a:46:22:98:ed:
    7c:7b:97:70:ac:e5:2e:5b:0b:05:5c:89:e6:df:00:
    fc:c4:20:03:3c:18:6e:4b:a2:2f:e4:7a:43:21:59:
    52:3e:f9:d5:b3:0d:36:cb:4d:85:24:2b:37:c3:f0:
    c4:73:81:05:2e:37:12:6a:91:a7:e0:e2:50:39:4f:
    a1
prime1:
    00:ea:d4:33:a0:5f:da:b2:a8:10:2a:be:a2:74:0b:
    f0:37:bd:8e:04:48:bc:9b:51:90:5b:a9:0b:78:f0:
    7d:d3:8a:f4:5c:f9:99:98:e4:27:67:f9:48:cd:00:
    a2:fb:94:88:96:0b:3d:87:f7:01:21:64:fe:d7:59:
    99:b3:65:84:ba:35:7f:23:d5:03:9f:b1:eb:aa:34:
    9c:95:ec:43:96:dd:d7:6d:01:17:51:a5:fe:a0:4d:
    20:a4:f1:24:84:9f:e8:01:3e:1e:f8:f2:25:6f:1d:
    82:38:f8:16:66:a4:c7:f9:17:70:ab:2d:a5:a3:0d:
    42:3f:ab:4a:f6:21:f9:3c:91
prime2:
    00:df:cc:c3:8a:b2:49:cb:dc:38:18:7f:26:3a:ed:
    21:03:1f:52:0b:31:4c:44:9d:a6:e2:cf:58:ae:bd:
    b6:73:ae:38:d8:21:49:53:a7:23:dd:01:ed:78:be:
    b1:98:22:34:f6:a1:8c:f0:79:16:15:32:ae:6a:fa:
    e8:0e:0e:ca:21:73:d1:93:d9:64:a7:c5:30:48:2e:
    13:36:24:2f:5e:43:f1:4d:1a:61:d8:b7:e8:37:2b:
    5b:12:2b:dd:d8:16:25:d6:fd:95:a3:f2:54:62:3f:
    a7:a7:b7:55:6f:a9:02:df:ad:98:f9:c3:a1:26:94:
    11:81:f2:ad:81:82:3b:04:6d
exponent1:
    56:e6:f2:b8:0d:e1:04:2e:97:d5:09:b9:5a:d2:b4:
    32:1c:8e:fa:dc:e4:17:62:86:d6:b4:e7:4e:f9:48:
    c7:49:6c:07:20:43:8c:46:1a:a3:2a:a8:9b:5c:f9:
    f3:ba:53:15:9b:d1:48:88:cb:3d:4d:7f:d5:b8:0d:
    de:4a:da:64:82:b9:ab:4c:00:4c:4f:ee:93:8d:66:
    c9:40:a6:fe:a4:d8:3d:39:a3:24:8f:16:7c:c2:2e:
    2b:7c:25:f4:82:ac:bc:10:fe:2b:48:89:3b:e6:a2:
    b3:6c:73:f5:c6:53:4e:c6:32:e6:d6:3c:ae:eb:90:
    31:b9:b5:43:02:ed:96:51
exponent2:
    00:da:5c:27:ce:83:f6:8c:f9:e9:a1:bd:2d:c8:00:
    e6:5c:ed:8a:57:71:5a:40:f8:b1:84:4b:5a:f3:e4:
    16:c8:f8:0c:6e:94:cb:be:db:2d:9a:cd:ee:ae:09:
    21:ae:96:71:a6:d2:29:79:d8:2b:3b:b3:9f:8a:b2:
    15:08:e2:55:46:1e:83:36:06:be:b7:13:26:f0:c6:
    43:e8:67:95:f0:1b:ca:ac:b8:39:10:03:20:87:f3:
    bd:80:15:5c:f7:21:64:fa:47:a2:61:bc:67:a9:15:
    02:b8:19:a1:3a:b9:65:1c:69:7d:00:f5:67:9f:04:
    89:b0:88:df:d1:a5:07:80:61
coefficient:
    30:bf:a2:53:4c:94:8f:91:59:b3:f5:fc:bc:b3:f1:
    64:9c:2e:65:4f:bb:18:73:35:1d:b2:57:84:7f:c1:
    65:8d:29:a0:1c:c1:34:58:ca:8f:c9:ae:e6:5d:fa:
    4f:8c:7e:11:9e:b2:4a:49:9f:27:98:ac:11:d5:dc:
    28:ee:8c:24:5b:a4:53:c6:07:50:c5:82:37:f6:19:
    a4:d8:3f:f7:65:cd:a0:1e:4f:b5:41:63:fd:bb:04:
    04:70:2e:d4:66:73:5e:07:23:a0:0f:38:ad:c8:2f:
    2d:0a:be:e1:47:db:f3:14:0a:0b:7c:d0:9a:a8:64:
    7a:ad:c6:7b:04:e1:83:8f
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Check the public key too:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl rsa <span class="nt">-in</span> public_key.pem <span class="nt">-pubin</span> <span class="nt">-text</span> <span class="nt">-noout</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre>Public-Key: <span class="o">(</span>2048 bit<span class="o">)</span>
Modulus:
    00:bb:24:9d:47:ba:81:6d:67:40:16:02:f6:b0:fa:
    19:84:bc:35:ed:e8:42:7a:7a:27:de:80:cc:75:2c:
    e8:df:a9:05:bf:bf:20:1c:05:e8:52:45:ee:87:61:
    a7:c1:93:d9:b9:b0:ad:8d:5b:93:24:4c:3e:65:e7:
    89:33:a3:1f:5b:34:02:86:84:00:0c:c5:76:2a:7f:
    d4:d4:0b:b2:77:cb:28:79:38:62:59:9e:ed:b2:18:
    bb:22:c8:ec:d3:f0:c8:1e:8a:82:b3:9d:cd:69:fa:
    62:39:53:46:ec:39:5c:b1:08:4e:ce:ae:86:d3:17:
    0b:3d:7f:ff:b9:75:a7:c0:64:f7:12:b3:42:51:17:
    03:cc:c9:58:11:23:c6:a1:9e:9a:c6:dd:07:62:29:
    51:81:ec:f4:de:66:ed:62:06:78:07:14:d8:5a:ce:
    75:ee:eb:17:87:7a:5c:b5:9c:7f:bd:4c:85:90:02:
    57:29:4e:c4:28:a7:2f:54:d9:f2:0c:40:94:32:10:
    d9:2c:fa:25:92:56:18:42:bd:51:5e:12:dd:e1:d8:
    ed:35:8e:58:c4:1e:57:66:0d:2b:e0:de:92:82:f4:
    ef:53:ad:3e:2a:93:e4:f3:d9:d7:38:92:60:dd:12:
    83:da:c2:18:a6:d5:30:1e:2f:6e:f9:01:0c:11:7a:
    28:83
Exponent: 65537 <span class="o">(</span>0x10001<span class="o">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<blockquote class="prompt-info">
  <p>We can see that public and private keys are just the holders of the mathematical product and properties of the key generation process.</p>
</blockquote>

<h4 id="how-to-use-it-to-encrypt-the-communication">How to use it to encrypt the communication</h4>

<p><img src="/assets/certs-in-and-outs/alice-bob.drawio.png" alt="asymmetric flow" style="display:block; margin-left:auto; margin-right:auto" /></p>

<p>In very oversimplified manner this happens</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre> <span class="kd">const</span> <span class="nx">privateKey</span> <span class="o">=</span> <span class="nf">randomString</span><span class="p">();</span>
 <span class="kd">const</span> <span class="nx">publicKey</span> <span class="o">=</span> <span class="nf">generatePublicKey</span><span class="p">(</span><span class="nx">privateKey</span><span class="p">);</span>
 <span class="kd">const</span> <span class="nx">plainMessage</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Hello Mr Bug!üêú</span><span class="dl">'</span><span class="p">;</span>
 
 <span class="kd">const</span> <span class="nx">encryptedMessage</span> <span class="o">=</span> <span class="nf">encrypt</span><span class="p">(</span><span class="nx">publicKey</span><span class="p">,</span> <span class="nx">plainMessage</span><span class="p">);</span>
 <span class="kd">const</span> <span class="nx">decryptedMessage</span> <span class="o">=</span> <span class="nf">decrypt</span><span class="p">(</span><span class="nx">encryptedMessage</span><span class="p">,</span> <span class="nx">privateKey</span><span class="p">);</span>
 <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">decryptedMessage</span><span class="p">);</span> <span class="c1">//'Hello Mr Bug!üêú'</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<h3 id="the-roles-of---public-and--private-keys">The roles of  üü¢ Public and üî¥ Private keys</h3>

<table>
  <thead>
    <tr>
      <th><strong>What one key does</strong></th>
      <th><strong>The other will validate</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>üü¢ Public encrypts</td>
      <td>üî¥ Private decrypts</td>
    </tr>
    <tr>
      <td>üî¥ Private digitally signs</td>
      <td>üü¢ Public verifies signature</td>
    </tr>
    <tr>
      <td>üî¥ Private authenticates</td>
      <td>üü¢ Public verifies authentication</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="key-exchange">Key exchange</h2>

<p>Since both communicating parties will send their public keys there is no need for any kind of secure key exchange protocol.</p>

<h2 id="public-key-infrastructure-pki">Public-Key Infrastructure (PKI)</h2>

<blockquote class="prompt-tip">
  <p>How the heck validate the cert? üòµ</p>
</blockquote>

<h3 id="the-hero-of-the-day---certificate-authorities-verification-authority">The hero of the day -&gt; Certificate Authorities (Verification Authority)</h3>

<ul>
  <li>A company that is considered trustworthy and produces digital certificates for other individuals and
companies (i.e. subjects) bearing that subject‚Äôs public key</li>
</ul>

<h4 id="tasks">Tasks</h4>

<ul>
  <li>issues digital certificates;</li>
  <li>helps establish trust between communicating entities over the internet;</li>
  <li>verifies domain names and organizations to validate their identities; and</li>
  <li>maintains <a href="https://www.techtarget.com/searchsecurity/definition/Certificate-Revocation-List">certificate revocation lists (CRL)</a>.‚õî</li>
  <li>understands <a href="https://www.e2encrypted.com/pki/pki-certificate-revoke-ocsp/#ocsp-request">Online Certificate Status Protocol  (OCSP)</a> and responds to clients regarding the validity of the cert</li>
</ul>

<h4 id="how-browsers-validate-the-certificate-of-the-website">How browsers validate the certificate of the website?</h4>

<p><img src="/assets/certs-in-and-outs/ca.drawio.png" alt="certs-in-and-outs" /></p>

<blockquote class="prompt-tip">
  <p>Browsers first checking the website cert against the os trusted root certs then
they are sending a request to the CRL endpoint based on the certificate CRL Endpoint field in the certificate of the website.</p>
</blockquote>

<p><img src="/assets/certs-in-and-outs/crl-example.png" alt="alt text" /></p>

<h3 id="how-new-certificates-can-be-validated---chain-of-trust">How new certificates can be validated? -&gt; Chain of trust</h3>

<blockquote class="prompt-info">
  <p>Hierarchy of certificates is used to verify the validity of a certificate‚Äôs issuer. This hierarchy is known as a <em>chain of trust</em>. In a chain of trust, certificates are issued and signed by certificates that live higher up in the hierarchy.
This way if the OS has some trusted root certificates pre installed it is easy to build a certificate hierarchy which can prove the validity of the leaf certificate.</p>
</blockquote>

<h4 id="chain-of-trust-tree-main-pillars-">Chain of trust tree main pillars üß±</h4>

<h4 id="trust-anchor">Trust Anchor</h4>

<ul>
  <li>A public cert key named as CA cert which is trusted by both of the communicating parties, usually exists at OS level</li>
</ul>

<h4 id="intermediate-cert">Intermediate Cert</h4>

<ul>
  <li>you cannot issue new cert from trusted public CA certs since you need a new layer</li>
  <li>extra security to provide validation for the CA cert</li>
  <li>cheaper then issuing new CA cert for every need. New CA cet is expensive because it requires special validations of the issuer company and the processes <a href="https://security.stackexchange.com/questions/24896/how-do-certification-authorities-store-their-private-root-keys">how this CA cert private keys are stored</a></li>
</ul>

<h4 id="end-entity-cert--leaf-cert">End Entity Cert / Leaf Cert</h4>

<ul>
  <li>no other cert can be above it</li>
  <li>represents the end entity of the chain</li>
</ul>

<h3 id="cert-validation-levels">Cert Validation Levels</h3>

<ul>
  <li>Domain Validation -&gt; the CA validates that the requestor really has the ownership of the domain in the csr. Usually asking to put a file in a specific path under the domain, or putting a new DNS subdomain entry under the domain</li>
  <li>Organization Validation -&gt; CA will contact the organization and will check every detail of the company that will be included in the cert</li>
  <li>Extended Validation -&gt; CA will make full background check of the organization, by actually visiting the company and checking the IDs of the key employees etc.. This certificate type will print the company name in the browser bar above the certificate</li>
</ul>

<h2 id="cert-validity-scopes">Cert Validity Scopes</h2>

<ul>
  <li>Single Domain Certs -&gt; for single domain</li>
  <li>Wildcard SSL Certs -&gt; valid for any subdomain of one domain</li>
  <li>Multi-Domain SAN SSL Cert -&gt; valid for multiple different domain</li>
  <li>Self signed certificates -&gt; only valid on machines which has the signing CA cert installed in the OS trust store</li>
</ul>

<hr />

<h2 id="certificate-standards">Certificate Standards</h2>

<blockquote class="prompt-question">
  <p><strong>Ok but how does everyone understands the certs?</strong></p>
</blockquote>

<h3 id="x509-for-the-win-">X.509 for the win! üèÜ</h3>

<blockquote class="prompt-tip">
  <p>This standard make possible to all participants in the PKI will understand the content of the certificate by enforcing that every information/property within a digital certificate are all placed in the same location and in the same order.</p>

</blockquote>

<h4 id="parts-Ô∏è">Parts üèóÔ∏è</h4>

<p>As you can see above we can easily inspect a certificate with the openssl utility:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl x509 <span class="nt">-in</span> alice.crt <span class="nt">-text</span> <span class="nt">-noout</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="data-section">Data Section</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
</pre></td><td class="rouge-code"><pre>Data:
        Version: 3 <span class="o">(</span>0x2<span class="o">)</span>
        Serial Number: 1 <span class="o">(</span>0x1<span class="o">)</span>
        Signature Algorithm: sha1WithRSAEncryption
        Issuer: <span class="nv">C</span><span class="o">=</span>FR, <span class="nv">ST</span><span class="o">=</span>Alsace, <span class="nv">L</span><span class="o">=</span>Strasbourg, <span class="nv">O</span><span class="o">=</span>www.freelan.org, <span class="nv">OU</span><span class="o">=</span>freelan, <span class="nv">CN</span><span class="o">=</span>Freelan Sample Certificate Authority, <span class="nv">emailAddress</span><span class="o">=</span>contact@freelan.org
        Validity
            Not Before: Apr 27 10:31:18 2012 GMT
            Not After : Apr 25 10:31:18 2022 GMT
        Subject: <span class="nv">C</span><span class="o">=</span>FR, <span class="nv">ST</span><span class="o">=</span>Alsace, <span class="nv">O</span><span class="o">=</span>www.freelan.org, <span class="nv">OU</span><span class="o">=</span>freelan, <span class="nv">CN</span><span class="o">=</span>alice, <span class="nv">emailAddress</span><span class="o">=</span>contact@freelan.org
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                Public-Key: <span class="o">(</span>4096 bit<span class="o">)</span>
                Modulus:
                    00:dd:6d:bd:f8:80:fa:d7:de:1b:1f:a7:a3:2e:b2:
                    02:e2:16:f6:52:0a:3c:bf:a6:42:f8:ca:dc:93:67:
                    4d:60:c3:4f:8d:c3:8a:00:1b:f1:c4:4b:41:6a:69:
                    d2:69:e5:3f:21:8e:c5:0b:f8:22:37:ad:b6:2c:4b:
                    55:ff:7a:03:72:bb:9a:d3:ec:96:b9:56:9f:cb:19:
                    99:c9:32:94:6f:8f:c6:52:06:9f:45:03:df:fd:e8:
                    97:f6:ea:d6:ba:bb:48:2b:b5:e0:34:61:4d:52:36:
                    0f:ab:87:52:25:03:cf:87:00:87:13:f2:ca:03:29:
                    16:9d:90:57:46:b5:f4:0e:ae:17:c8:0a:4d:92:ed:
                    08:a6:32:23:11:71:fe:f2:2c:44:d7:6c:07:f3:0b:
                    7b:0c:4b:dd:3b:b4:f7:37:70:9f:51:b6:88:4e:5d:
                    6a:05:7f:8d:9b:66:7a:ab:80:20:fe:ee:6b:97:c3:
                    49:7d:78:3b:d5:99:97:03:75:ce:8f:bc:c5:be:9c:
                    9a:a5:12:19:70:f9:a4:bd:96:27:ed:23:02:a7:c7:
                    57:c9:71:cf:76:94:a2:21:62:f6:b8:1d:ca:88:ee:
                    09:ad:46:2f:b7:61:b3:2c:15:13:86:9f:a5:35:26:
                    5a:67:f4:37:c8:e6:80:01:49:0e:c7:ed:61:d3:cd:
                    bc:e4:f8:be:3f:c9:4e:f8:7d:97:89:ce:12:bc:ca:
                    b5:c6:d2:e0:d9:b3:68:3c:2e:4a:9d:b4:5f:b8:53:
                    ee:50:3d:bf:dd:d4:a2:8a:b6:a0:27:ab:98:0c:b3:
                    b2:58:90:e2:bc:a1:ad:ff:bd:8e:55:31:0f:00:bf:
                    68:e9:3d:a9:19:9a:f0:6d:0b:a2:14:6a:c6:4c:c6:
                    4e:bd:63:12:a5:0b:4d:97:eb:42:09:79:53:e2:65:
                    aa:24:34:70:b8:c1:ab:23:80:e7:9c:6c:ed:dc:82:
                    aa:37:04:b8:43:2a:3d:2a:a8:cc:20:fc:27:5d:90:
                    26:58:f9:b7:14:e2:9e:e2:c1:70:73:97:e9:6b:02:
                    8e:d3:52:59:7b:00:ec:61:30:f1:56:3f:9c:c1:7c:
                    05:c5:b1:36:c8:18:85:cf:61:40:1f:07:e8:a7:06:
                    87:df:9a:77:0b:a9:64:72:03:f6:93:fc:e0:02:59:
                    c1:96:ec:c0:09:42:3e:30:a2:7f:1b:48:2f:fe:e0:
                    21:8f:53:87:25:0d:cb:ea:49:f5:4a:9b:d0:e3:5f:
                    ee:78:18:e5:ba:71:31:a9:04:98:0f:b1:ad:67:52:
                    a0:f2:e3:9c:ab:6a:fe:58:84:84:dd:07:3d:32:94:
                    05:16:45:15:96:59:a0:58:6c:18:0e:e3:77:66:c7:
                    b3:f7:99
                Exponent: 65537 <span class="o">(</span>0x10001<span class="o">)</span>
        X509v3 extensions:
            X509v3 Basic Constraints: 
                CA:FALSE
            Netscape Comment: 
                OpenSSL Generated Certificate
            X509v3 Subject Key Identifier: 
                59:5F:C9:13:BA:1B:CC:B9:A8:41:4A:8A:49:79:6A:36:F6:7D:3E:D7
            X509v3 Authority Key Identifier: 
                23:6C:2D:3D:3E:29:5D:78:B8:6C:3E:AA:E2:BB:2E:1E:6C:87:F2:53
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="signature-section">Signature Section</h4>

<ul>
  <li>The cipher algorithm ‚Äì the algorithm used by the issuer to create a digital signature</li>
  <li>The digital signature for the CA ‚Äì a hash of all the information in the certificate encrypted with the CA private key</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre> Signature Algorithm: sha1WithRSAEncryption
    Signature Value:
        13:e7:02:45:3e:a7:ab:bd:b8:da:e7:ef:74:88:ac:62:d5:dd:
        10:56:d5:46:07:ec:fa:6a:80:0c:b9:62:be:aa:08:b4:be:0b:
        eb:9a:ef:68:b7:69:6f:4d:20:92:9d:18:63:7a:23:f4:48:87:
        6a:14:c3:91:98:1b:4e:08:59:3f:91:80:e9:f4:cf:fd:d5:bf:
        af:4b:e4:bd:78:09:71:ac:d0:81:e5:53:9f:3e:ac:44:3e:9f:
        f0:bf:5a:c1:70:4e:06:04:ef:dc:e8:77:05:a2:7d:c5:fa:80:
        58:0a:c5:10:6d:90:ca:49:26:71:84:39:b7:9a:3e:e9:6f:ae:
        c5:35:b6:5b:24:8c:c9:ef:41:c3:b1:17:b6:3b:4e:28:89:3c:
        7e:87:a8:3a:a5:6d:dc:39:03:20:20:0b:c5:80:a3:79:13:1e:
        f6:ec:ae:36:df:40:74:34:87:46:93:3b:a3:e0:a4:8c:2f:43:
        4c:b2:54:80:71:76:78:d4:ea:12:28:d8:f2:e3:80:55:11:9b:
        f4:65:dc:53:0e:b4:4c:e0:4c:09:b4:dc:a0:80:5c:e6:b5:3b:
        95:d3:69:e4:52:3d:5b:61:86:02:e5:fd:0b:00:3a:fa:b3:45:
        cc:c9:a3:64:f2:dc:25:59:89:58:0d:9e:6e:28:3a:55:45:50:
        5f:88:67:2a:d2:e2:48:cc:8b:de:9a:1b:93:ae:87:e1:f2:90:
        50:40:d9:0f:44:31:53:46:ad:62:4e:8d:48:86:19:77:fc:59:
        75:91:79:35:59:1d:e3:4e:33:5b:e2:31:d7:ee:52:28:5f:0a:
        70:a7:be:bb:1c:03:ca:1a:18:d0:f5:c1:5b:9c:73:04:b6:4a:
        e8:46:52:58:76:d4:6a:e6:67:1c:0e:dc:13:d0:61:72:a0:92:
        cb:05:97:47:1c:c1:c9:cf:41:7d:1f:b1:4d:93:6b:53:41:03:
        21:2b:93:15:63:08:3e:2c:86:9e:7b:9f:3a:09:05:6a:7d:bb:
        1c:a7:b7:af:96:08:cb:5b:df:07:fb:9c:f2:95:11:c0:82:81:
        f6:1b:bf:5a:1e:58:cd:28:ca:7d:04:eb:aa:e9:29:c4:82:51:
        2c:89:61:95:b6:ed:a5:86:7c:7c:48:1d:ec:54:96:47:79:ea:
        <span class="nb">fc</span>:7f:f5:10:43:0a:9b:00:ef:8a:77:2e:f4:36:66:d2:6a:a6:
        95:b6:9f:23:3b:12:e2:89:d5:a4:c1:2c:91:4e:cb:94:e8:3f:
        22:0e:21:f9:b8:4a:81:5c:4c:63:ae:3d:05:b2:5c:5c:54:a7:
        55:8f:98:25:55:c4:a6:90:bc:19:29:b1:14:d4:e2:b0:95:e4:
        ff:89:71:61:be:8a:16:85
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="pkcs7-cryptographic-message-syntax-standard">PKCS#7 (Cryptographic Message Syntax Standard)</h3>

<ul>
  <li>PKCS7 is standard used to sign and encrypt messages particularly in email communications or to sign digital documents for example emails or pdfs etc..</li>
  <li>File extension: .p7b, .p7c, .p7m, .p7s</li>
  <li>The key is not bundled in the file</li>
  <li>One or more certificate packaged together but not signed or encrypted</li>
  <li>The signed document cannot be read without special tools like openssl</li>
</ul>

<h4 id="create-pkcs7-cert-and-key-and-sign-and-verify-a-document">Create pkcs7 cert and key and sign and verify a document</h4>

<ul>
  <li>generate a key</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl genrsa <span class="nt">-out</span> private.key 2048
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>generate a self signed cert</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl req <span class="nt">-new</span> <span class="nt">-x509</span> <span class="nt">-key</span> private.key <span class="nt">-out</span> certificate.crt <span class="nt">-days</span> 365 <span class="nt">-subj</span> <span class="s2">"/C=US/ST=State/L=City/O=Organization/OU=Unit/CN=CommonName"</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>create the test message that we want to sign</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">echo</span> <span class="s2">"This is a test message."</span> <span class="o">&gt;</span> message.txt
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>sign the document</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl smime <span class="nt">-sign</span> <span class="nt">-in</span> message.txt <span class="nt">-out</span> signed_message.p7s <span class="nt">-signer</span> certificate.crt <span class="nt">-inkey</span> private.key <span class="nt">-outform</span> DER <span class="nt">-nodetach</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>print cert from signed document</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl pkcs7 <span class="nt">-in</span> signed_message.p7s <span class="nt">-print_certs</span> <span class="nt">-noout</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>verify the document with</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl smime <span class="nt">-verify</span> <span class="nt">-in</span> signed_message.p7s <span class="nt">-CAfile</span> certificate.crt <span class="nt">-inform</span> DER
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl smime <span class="nt">-sign</span> <span class="nt">-in</span> message.txt <span class="nt">-out</span> signed_message.p7s <span class="nt">-signer</span> certificate.crt <span class="nt">-inkey</span> private.key <span class="nt">-outform</span> DER <span class="nt">-nodetach</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="certificate-formats">Certificate formats</h2>
<blockquote>

  <p>Certificate format is the way how the certificate is encoded, stored and which file extension is used.</p>
</blockquote>

<h3 id="binary-encoded">Binary encoded</h3>

<h4 id="der-distinguished-encoding-rules">.DER (Distinguished Encoding Rules)</h4>

<ul>
  <li>File extensions: .der, .cer</li>
  <li>It is not a bundle format so either the key or the cert is stored in it</li>
  <li>Often used by Java applications running as web servers</li>
  <li>There are no human readable headers in the file</li>
</ul>

<h5 id="how-to-create-and-read-it">How to create and read it?</h5>

<ul>
  <li>Generate an rsa key</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl genrsa <span class="nt">-out</span> private.key 2048
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>generate a self signed cert with this key</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl req <span class="nt">-new</span> <span class="nt">-x509</span> <span class="nt">-key</span> private.key <span class="nt">-out</span> certificate.crt <span class="nt">-days</span> 365
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Convert private key to der format</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl rsa <span class="nt">-in</span> private.key <span class="nt">-outform</span> DER <span class="nt">-out</span> private.der
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Convert cert to der format</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl x509 <span class="nt">-in</span> certificate.crt <span class="nt">-outform</span> DER <span class="nt">-out</span> certificate.der
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Read the created cert</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl x509 <span class="nt">-in</span> certificate.der <span class="nt">-inform</span> DER <span class="nt">-text</span> <span class="nt">-noout</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Read the created key</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl rsa <span class="nt">-in</span> private.der <span class="nt">-inform</span> DER <span class="nt">-text</span> <span class="nt">-noout</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="pkcs12-public-key-cryptographic-standards-sometimes-references-as-pfx">PKCS#12 (Public-Key Cryptographic Standards) sometimes references as PFX</h4>

<ul>
  <li>File extensions: .pfx, .p12</li>
  <li>This file is encrypted and protected with a password</li>
  <li>The pfx file contain multiple cryptographic objects including public key certificates, private keys, intermediate keys.</li>
  <li>One or more certificates packed together, password-encrypted</li>
  <li>Use: you want to store and transfer your private keys and cert bundles securely</li>
</ul>

<h5 id="how-to-create-and-read-it-1">How to create and read it?</h5>

<ul>
  <li>generate the private key</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl genrsa <span class="nt">-out</span> private.key 2048
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>create a self signed certificate with you new key</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl req <span class="nt">-new</span> <span class="nt">-x509</span> <span class="nt">-key</span> private.key <span class="nt">-out</span> certificate.crt <span class="nt">-days</span> 365
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>create the pfx file</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl pkcs12 <span class="nt">-export</span> <span class="nt">-out</span> certificate.pfx <span class="nt">-inkey</span> private.key <span class="nt">-in</span> certificate.crt
</pre></td></tr></tbody></table></code></pre></div></div>

<p>As you noticed this export asked for a password. This will be needed when we want to read the pfx like this:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl pkcs12 <span class="nt">-info</span> <span class="nt">-in</span> input.pfx
</pre></td></tr></tbody></table></code></pre></div></div>

<p>This will output something like this:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
</pre></td><td class="rouge-code"><pre>‚ùØ openssl pkcs12 <span class="nt">-info</span> <span class="nt">-in</span> certificate.pfx
Enter Import Password:
MAC: sha256, Iteration 2048
MAC length: 32, salt length: 8
PKCS7 Encrypted data: PBES2, PBKDF2, AES-256-CBC, Iteration 2048, PRF hmacWithSHA256
Certificate bag
Bag Attributes
    localKeyID: 69 0A CA 69 19 B8 23 24 CD DE B9 F8 D1 C8 CA 19 F0 63 68 F5 
<span class="nv">subject</span><span class="o">=</span><span class="nv">C</span><span class="o">=</span>AU, <span class="nv">ST</span><span class="o">=</span>Some-State, <span class="nv">O</span><span class="o">=</span>Internet Widgits Pty Ltd
<span class="nv">issuer</span><span class="o">=</span><span class="nv">C</span><span class="o">=</span>AU, <span class="nv">ST</span><span class="o">=</span>Some-State, <span class="nv">O</span><span class="o">=</span>Internet Widgits Pty Ltd
<span class="nt">-----BEGIN</span> CERTIFICATE-----
MIIDazCCAlOgAwIBAgIUCz7AnQ57KFLQTEhMv+2H2c1u7vwwDQYJKoZIhvcNAQEL
BQAwRTELMAkGA1UEBhMCQVUxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoM
GEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDAeFw0yNDExMjIxMDIzNDBaFw0yNTEx
MjIxMDIzNDBaMEUxCzAJBgNVBAYTAkFVMRMwEQYDVQQIDApTb21lLVN0YXRlMSEw
HwYDVQQKDBhJbnRlcm5ldCBXaWRnaXRzIFB0eSBMdGQwggEiMA0GCSqGSIb3DQEB
AQUAA4IBDwAwggEKAoIBAQCXxyB1Pl7U55vnwgS2qcjrfG0sRaP7L3d3/NTD+bx3
iOYXLA91oDaBM3aBtJOFCTmhA/dAkeBfnxIA0nCuNGR2B+IyOkXipZlk/825HCnP
1QtFlRxpo7Hdq8+JqjGG+/0b3DghB3/0hH/xuGUD22cQmgJAL9ue6cIYx2Kp8Lxp
tqsfBQ/1EDHoJRFr3SyLyxWcPVgoGucYzAmifsGIMD2/8blNuynDTmOSdAJX6/XQ
Z7QzCqwFJQ6RO3oCWsIVg1O+oNPlyvbehho0Up0wRJoAWFS4476A9+n9iD9qQIUc
S1hHkkYw5UTzSCbsve1nIbRSHgbCMgJYNkb4GN8e8caLAgMBAAGjUzBRMB0GA1Ud
DgQWBBRJjaQ1lt9rWS4+Lfi9v+a21GlWHjAfBgNVHSMEGDAWgBRJjaQ1lt9rWS4+
Lfi9v+a21GlWHjAPBgNVHRMBAf8EBTADAQH/MA0GCSqGSIb3DQEBCwUAA4IBAQBb
jGYjULouJmqdYP6GIfHoZP4JrenU9yRnZIfW14d2uDMlCwgTXYch/4ibl6S4Pa6X
NPLeDL71WCC5l90R26cnsZzI5Ns/4jt7IxdAhhQl7yLe9kWFXxHBtLhiONb6UkjR
JVNj2SUG2NpNHHN7+ZE/uScPexHRhuDOgcEnx7QUQvlQwrUy+ck9dkwV+EsIWhZR
7kBqVanfQ4nKmkdr2a2nGbcZk4SGsSx5R56xYwXuiuphAOj9TUBi7IGDHbvfpBQt
uw7YyIkDrHDxnCaF2jVVJARANSoJ5/7oB0GIKMdLVdzomtJCQuaORdAjRT5iKPYO
TocjY9zu+zOS774OgGbU
<span class="nt">-----END</span> CERTIFICATE-----
PKCS7 Data
Shrouded Keybag: PBES2, PBKDF2, AES-256-CBC, Iteration 2048, PRF hmacWithSHA256
Bag Attributes
    localKeyID: 69 0A CA 69 19 B8 23 24 CD DE B9 F8 D1 C8 CA 19 F0 63 68 F5 
Key Attributes: &lt;No Attributes&gt;
Enter PEM pass phrase:
Verifying - Enter PEM pass phrase:
<span class="nt">-----BEGIN</span> ENCRYPTED PRIVATE KEY-----
MIIFNTBfBgkqhkiG9w0BBQ0wUjAxBgkqhkiG9w0BBQwwJAQQmh45yx3+OoIeYwG0
yVMEgwICCAAwDAYIKoZIhvcNAgkFADAdBglghkgBZQMEASoEEOQ78AVEq+EcPEW9
os1+xxMEggTQLSg2nLT7sIjvU7I0Embkg0XviYhLIGS6kaRis14aMAvJayTcv3C0
nSHlf6mxnkfvqt6wKgNui3x7qAXtubxQKC0MXG9nXt8VHfoHUI1J3h/URLBIRHyv
R5PuNZDdQ1dEeqUcrVzTIt4wrP82Nx9yPD3ICS+tJaNZTJPYvrABofljaXFJth3U
EIGriuUM3qpcpfFhkGduiJDijxRYcI95QZERcDJ/VpX2ZEa5ad+YdYRT9t12VbhV
lQhWvT5gcM/3GDuRKvDveCOqTlxwNFmy0Gus3R01Z/cvDwVRd8SvNIYPjKIb7MuW
sg0l1VayRhN81TUCA8dgyvdsDjrMx8X3WH4vqxNZ5BJymRfkJi75VhC0Tm/OifDh
VwO9tTn/U/MFIZggK5IuaZl9y9fbmiYCFSFtMxz6euBj7eXyT4xJTBuzNURwQ3R2
S4aObz/tj5H7aIP4qpVCLTSRaXbuB/2h70HMgOJal6JHpKAzDKFiPhPQFOll1D2E
eQP8iS7X6k6HgDixJ0PUb6mlqBwVEINO0oekPaWpiE7zgyNZIEw4U4Z6dilmlcTt
RX+0smZ7T+j8mNx0aQLboIOnoNVLgiNgZCyb1lZFtkHBGBS51giz7Gaen+W4HjLz
/Gv66/HHXK1oJxtJvUyiSxNVWtu/AwGwv99u5ahC97Ct/C7nTDVF7hj2Q2RMYdxN
OVnK1OOkp+7cKlp8aHAkKdhlp1JswhcMCFv+aOtpNWgFOyvsWQUJGZ8BI19qLDZ5
iuNn5EUlw7PsS+7XPDlVarjYjzBYcEwG4E4ukxPkFw/bWVvdtAdOIsiBvx91hTT/
vCkF92lm/lckYARaucSZ0PRGD9ozbhw/6xcImCF6ME764VxkhESvlDNqLoAY4MUa
5GSLLnDdhzPkuYLqnzoZiKiBC1Y4QZ47KsRnZtiFJwCLXuxU982qT7bxVEIWRHt9
ER0iSHSVcNsr7ThBk1o25cDpyd5qO+VANzrBZ+yz1ROiiFfwiFgSLPLK0rlyRQM3
oSHDtUYVqe3ZF7wdEnGV3c4UfpyDrU1EWxv4JK44Kx6fMS+T/gvsW4HpNG9aOwa9
cMbTZ0i8z+amiFu402vGFo7fa+3R1ztb90OaasDtqgty11tcW+bN0oTp+fNp7d/M
WsINwe/W2UJSkQvnEHkgs0GytmGAL84O0D5Zbqvv9tzBzzpn9wzoGI6jec58epzv
uRhnBJ0cqDvPOV2NhXx1uGUP44A0eR5BK/mxj22m+uh+5IW9Kfk+8q5fHXQkDkKp
qqXS5K6kjLp8WZurdeWFHevoEZqaSF86lGSXMNn2Zv98oJmSrnXV90h4qB465zm5
ya4vJHX0+yVIXfFRpBqCaRcTB4BGZj33fIxp+baAZMOTIsl4Y82lFcW7JojrNa0p
kxsAKE2GUukVdogysS5oGAtUbnB8oOckGBRt1UZ+M5AHgWKrCKQHK18VOK0QFw6V
sgeyOorZpqBCCWuvVSR2n9KsBWyUtvo5Sb9xUt2YERi5EVctWHfCFRhFXP3u6qX/
3WKZySiYAPrerUuAQe+wG3esjxPXf9qv1uKLmRC7pUD/raACbECE63nKBSlltMss
1uUl+6lCn1ingASa7hbJ04UK11V4DW8ukDCkR95cu8cKP7nGm1mc+Fc<span class="o">=</span>
<span class="nt">-----END</span> ENCRYPTED PRIVATE KEY-----
</pre></td></tr></tbody></table></code></pre></div></div>

<blockquote class="prompt-tip">
  <p>As you can see it really contains the cert and the encrypted private key. This is a safe format to store and share your certificate bundles</p>
</blockquote>

<h3 id="base64-ascii">Base64 (ASCII)</h3>

<h4 id="pem-privacy-enhanced-mail">.PEM (Privacy-Enhanced Mail)</h4>

<ul>
  <li>File extensions: .pem, .crt, .cer, .key</li>
  <li>There is no encryption to protect the keys so the owner has to transfer them securely</li>
  <li>Default format for OpenSSL. Suitable for sending files as text between systems</li>
  <li>Can contain multiple certs in one file by simply concatenating the key and cert</li>
  <li>Certificates are surrounded with:
    <ul>
      <li>‚Äî‚ÄìBEGIN CERTIFICATE‚Äî‚Äì</li>
      <li>‚Äî‚ÄìEND CERTIFICATE‚Äî‚Äì</li>
    </ul>
  </li>
  <li>Keys are surrounded with:
    <ul>
      <li>‚Äî‚ÄìBEGIN RSA PRIVATE KEY‚Äî‚Äì</li>
      <li>‚Äî‚ÄìEND RSA PRIVATE KEY‚Äî‚Äì</li>
    </ul>
  </li>
  <li>There are cases when more then one cert / key has to be included in the file like when the server does SSL termination and other intermediate cert is required to establish the full chain of trust:</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="nt">-----BEGIN</span> RSA PRIVATE KEY-----
... <span class="o">(</span>private key data<span class="o">)</span> ...
<span class="nt">-----END</span> RSA PRIVATE KEY-----
<span class="nt">-----BEGIN</span> CERTIFICATE-----
... <span class="o">(</span>server certificate data<span class="o">)</span> ...
<span class="nt">-----END</span> CERTIFICATE-----
<span class="nt">-----BEGIN</span> CERTIFICATE-----
... <span class="o">(</span>intermediate certificate data<span class="o">)</span> ...
<span class="nt">-----END</span> CERTIFICATE-----
<span class="nt">-----BEGIN</span> CERTIFICATE-----
... <span class="o">(</span>root certificate data<span class="o">)</span> ...
<span class="nt">-----END</span> CERTIFICATE-----
</pre></td></tr></tbody></table></code></pre></div></div>

<p>How to create and read them:</p>

<ul>
  <li>generate key</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl genrsa <span class="nt">-out</span> private.key 2048
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>generate a self signed cert</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl req <span class="nt">-new</span> <span class="nt">-x509</span> <span class="nt">-key</span> private.key <span class="nt">-out</span> certificate.pem <span class="nt">-days</span> 365
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>combine them in one file</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">cat </span>private.key certificate.pem <span class="o">&gt;</span> combined.pem
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Reading only the key from this combined file</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl rsa <span class="nt">-in</span> combined.pem <span class="nt">-text</span> <span class="nt">-noout</span>           
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Reading all the certs from this combined file</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl x509 <span class="nt">-in</span> combined.pem <span class="nt">-text</span> <span class="nt">-noout</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<h2 id="how-to-get-a-new-certificate">How to get a new certificate?</h2>

<h3 id="option-a--asking-the-the-big-brother-ca-with-a-love-letter-csr-to-create-one-for-you">Option A:  Asking the the big brother (CA) with a love letter (CSR) to create one for you!</h3>

<ul>
  <li>you should decide the certificate type</li>
  <li>select a Certificate Authority like
    <ul>
      <li>DigiCert</li>
      <li>GlobalSign</li>
      <li>Sectigo</li>
      <li>GoDaddy</li>
      <li>etc..</li>
    </ul>
  </li>
  <li>the CA will ask for a proof of domain ownership
    <ul>
      <li>email validation:
        <ul>
          <li>The CA will send a verification email message to an email address under your domain</li>
        </ul>
      </li>
      <li>DNS validation:
        <ul>
          <li>CA will ask you to put a new TXT entry under your domain name with a specific value</li>
        </ul>
      </li>
      <li>HTTP validation:
        <ul>
          <li>CA will ask you to upload a file to a specific path which can be reached through your domain like domain/.wellknown/pki-validation/</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Send the CSR file and present the necessary extra documentation for EV/OV validation like utility bills, public records etc..</li>
  <li>CA will issue your new certificate and send it back to you</li>
</ul>

<h4 id="example-to-create-and-decode-csr">Example to create and decode CSR</h4>

<p>(Useful online tool to decode CSRs) <a href="https://ssltools.godaddy.com/views/csrDecoder">https://ssltools.godaddy.com/views/csrDecoder</a></p>

<ul>
  <li>generate csr</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl req <span class="nt">-newkey</span> rsa:2048 <span class="nt">-keyout</span> example.key <span class="nt">-out</span> example.csr
</pre></td></tr></tbody></table></code></pre></div></div>

<p>This will create a key and a csr. Lets see the csr:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
       ‚îÇ File: example.csr
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
   1   ‚îÇ <span class="nt">-----BEGIN</span> CERTIFICATE REQUEST-----
   2   ‚îÇ MIIC9DCCAdwCAQAwfTELMAkGA1UEBhMCSFUxDjAMBgNVBAgMBUZlamVyMRAwDgYD
   3   ‚îÇ VQQHDAdWZWxlbmNlMRAwDgYDVQQKDAdUZWxla29tMRkwFwYDVQQDDBB0ZXN0LmV4
   4   ‚îÇ YW1wbGUuY29tMR8wHQYJKoZIhvcNAQkBFhB0ZXN0QGV4YW1wbGUuY29tMIIBIjAN
   5   ‚îÇ BgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAn7WtQNMvPgWGRkQk3NyZpv+HHRL/
   6   ‚îÇ 5mxHluJ1u5v2V+1Q+zP0ctKFmksOP/hlSlj7v7+QWYuqWLlA4vqCx43lzLN8f6pB
   7   ‚îÇ WHtefYXKBHm8cT05QvAPXfeWmulGTsKESB+SETiAzjuep6+kVmslomogQnkk0sr8
   8   ‚îÇ xAye/XlrdPSkN1IKljIHpSi0+eR2oyr1PfJoBvin5qZDTg6DP43N5MpaCyFOGwTB
   9   ‚îÇ 9PPprtHo8jJ0u9j60Brv7ED7VkygVbwpNEfMznjDaSKKCpB/8Xlvn9oxc182956U
  10   ‚îÇ 4Vc5VKThCe9NE3PCOb2a2DDGXAOipY1r+l/fFAmNI9TzJaFP0fCnmYtXhwIDAQAB
  11   ‚îÇ oDIwEwYJKoZIhvcNAQkHMQYMBHRlc3QwGwYJKoZIhvcNAQkCMQ4MDHRlc3QgY29t
  12   ‚îÇ cGFueTANBgkqhkiG9w0BAQsFAAOCAQEAWAXxLyInas6xsVExlSi8w7Pkl238oHNc
  13   ‚îÇ 3Oj9MJNVw1iiBMMgL9WBrIQ8g/Qn64eJi+IMKz0oan+2ajfOZhsRziuS5u24PuvP
  14   ‚îÇ TNNqq2hr5AqOAnzGZyHP0hqwIJpm2O3gQh6/4GpphxwEbr41zGtv3rzXl2DjZMyw
  15   ‚îÇ 0fXQsxBlys2O/y75amB3qrNM1WhFNnC4o+auIsocDckXuBvjx2oOzx3MJxt4J+V9
  16   ‚îÇ fRSzdCqWAnkCyePaxvoiO9l/YRReG7Cfi59PCo4DnVcWOqvSyutJ5em4IBxDCMH8
  17   ‚îÇ <span class="nv">SZKQBrGKRkFfM1ax7UDCCOvCghEBW5Wg56r1HD89zXeZVzu1nQyZFg</span><span class="o">==</span>
  18   ‚îÇ <span class="nt">-----END</span> CERTIFICATE REQUEST-----
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Nothing too fancy right?</p>

<p>Lets dissect it:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl req <span class="nt">-in</span> example.csr <span class="nt">-noout</span> <span class="nt">-text</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre></td><td class="rouge-code"><pre>Certificate Request:
    Data:
        Version: 1 <span class="o">(</span>0x0<span class="o">)</span>
        Subject: <span class="nv">C</span><span class="o">=</span>HU, <span class="nv">ST</span><span class="o">=</span>Fejer, <span class="nv">L</span><span class="o">=</span>Velence, <span class="nv">O</span><span class="o">=</span>Telekom, <span class="nv">CN</span><span class="o">=</span>test.example.com, <span class="nv">emailAddress</span><span class="o">=</span><span class="nb">test</span>@example.com
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                Public-Key: <span class="o">(</span>2048 bit<span class="o">)</span>
                Modulus:
                    00:9f:b5:ad:40:d3:2f:3e:05:86:46:44:24:dc:dc:
                    99:a6:ff:87:1d:12:ff:e6:6c:47:96:e2:75:bb:9b:
                    f6:57:ed:50:fb:33:f4:72:d2:85:9a:4b:0e:3f:f8:
                    65:4a:58:fb:bf:bf:90:59:8b:aa:58:b9:40:e2:fa:
                    82:c7:8d:e5:cc:b3:7c:7f:aa:41:58:7b:5e:7d:85:
                    ca:04:79:bc:71:3d:39:42:f0:0f:5d:f7:96:9a:e9:
                    46:4e:c2:84:48:1f:92:11:38:80:ce:3b:9e:a7:af:
                    a4:56:6b:25:a2:6a:20:42:79:24:d2:ca:fc:c4:0c:
                    9e:fd:79:6b:74:f4:a4:37:52:0a:96:32:07:a5:28:
                    b4:f9:e4:76:a3:2a:f5:3d:f2:68:06:f8:a7:e6:a6:
                    43:4e:0e:83:3f:8d:cd:e4:ca:5a:0b:21:4e:1b:04:
                    c1:f4:f3:e9:ae:d1:e8:f2:32:74:bb:d8:fa:d0:1a:
                    ef:ec:40:fb:56:4c:a0:55:bc:29:34:47:cc:ce:78:
                    c3:69:22:8a:0a:90:7f:f1:79:6f:9f:da:31:73:5f:
                    36:f7:9e:94:e1:57:39:54:a4:e1:09:ef:4d:13:73:
                    c2:39:bd:9a:d8:30:c6:5c:03:a2:a5:8d:6b:fa:5f:
                    <span class="nb">df</span>:14:09:8d:23:d4:f3:25:a1:4f:d1:f0:a7:99:8b:
                    57:87
                Exponent: 65537 <span class="o">(</span>0x10001<span class="o">)</span>
        Attributes:
            challengePassword        :test
            unstructuredName         :test company
            Requested Extensions:
    Signature Algorithm: sha256WithRSAEncryption
    Signature Value:
        58:05:f1:2f:22:27:6a:ce:b1:b1:51:31:95:28:bc:c3:b3:e4:
        97:6d:fc:a0:73:5c:dc:e8:fd:30:93:55:c3:58:a2:04:c3:20:
        2f:d5:81:ac:84:3c:83:f4:27:eb:87:89:8b:e2:0c:2b:3d:28:
        6a:7f:b6:6a:37:ce:66:1b:11:ce:2b:92:e6:ed:b8:3e:eb:cf:
        4c:d3:6a:ab:68:6b:e4:0a:8e:02:7c:c6:67:21:cf:d2:1a:b0:
        20:9a:66:d8:ed:e0:42:1e:bf:e0:6a:69:87:1c:04:6e:be:35:
        cc:6b:6f:de:bc:d7:97:60:e3:64:cc:b0:d1:f5:d0:b3:10:65:
        ca:cd:8e:ff:2e:f9:6a:60:77:aa:b3:4c:d5:68:45:36:70:b8:
        a3:e6:ae:22:ca:1c:0d:c9:17:b8:1b:e3:c7:6a:0e:cf:1d:cc:
        27:1b:78:27:e5:7d:7d:14:b3:74:2a:96:02:79:02:c9:e3:da:
        c6:fa:22:3b:d9:7f:61:14:5e:1b:b0:9f:8b:9f:4f:0a:8e:03:
        9d:57:16:3a:ab:d2:ca:eb:49:e5:e9:b8:20:1c:43:08:c1:fc:
        49:92:90:06:b1:8a:46:41:5f:33:56:b1:ed:40:c2:08:eb:c2:
        82:11:01:5b:95:a0:e7:aa:f5:1c:3f:3d:cd:77:99:57:3b:b5:
        9d:0c:99:16
</pre></td></tr></tbody></table></code></pre></div></div>

<blockquote>
  <p>You can see there is a signature with the private key and all the properties that can be validated by the CA. The CA will validate these data during the process. This validation is different based on the required validation scope and level.</p>
</blockquote>

<h3 id="option-b-self-signed">Option B: Self signed</h3>

<p>We have already created some self signed certificate above, but now we will create it a way that the OS will trust it! To achieve this we have to create a CA cert also and add it to the OS
trusted root cert store, then create a CSR which will be signed by our root CA cert.</p>

<ul>
  <li>Create key for CA cert</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl genrsa <span class="nt">-out</span> rootCA.key 2048
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Create root certificate</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl req <span class="nt">-x509</span> <span class="nt">-new</span> <span class="nt">-nodes</span> <span class="nt">-key</span> rootCA.key <span class="nt">-sha256</span> <span class="nt">-days</span> 3650 <span class="nt">-out</span> rootCA.crt
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Add to the OS trusted root cert store (linux)</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo cp </span>rootCA.crt /usr/local/share/ca-certificates/
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Apply it</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>update-ca-certificates
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Okay now create our server key</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl genrsa <span class="nt">-out</span> server.key 2048
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Now we have to create a CSR which will be signed by the CA cert later</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl req <span class="nt">-new</span> <span class="nt">-key</span> server.key <span class="nt">-out</span> server.csr
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Time to sign the CSR with CA cert</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl x509 <span class="nt">-req</span> <span class="nt">-in</span> server.csr <span class="nt">-CA</span> rootCA.crt <span class="nt">-CAkey</span> rootCA.key <span class="nt">-CAcreateserial</span> <span class="nt">-out</span> server.crt <span class="nt">-days</span> 365 <span class="nt">-sha256</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="try-it-out">Try it out!</h4>

<ul>
  <li>start a test server with openssl (amazing right? It is capable of this)</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl s_server <span class="nt">-cert</span> server.crt <span class="nt">-key</span> server.key <span class="nt">-CAfile</span> rootCA.crt <span class="nt">-accept</span> 4433
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>In a new terminal try to connect it</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl s_client <span class="nt">-connect</span> localhost:4433 <span class="nt">-CAfile</span> rootCA.crt
</pre></td></tr></tbody></table></code></pre></div></div>

<p>With this commands you can deeply debug your certificate and the TLS session itself</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre>‚ùØ openssl s_server <span class="nt">-cert</span> server.crt <span class="nt">-key</span> server.key <span class="nt">-CAfile</span> rootCA.crt <span class="nt">-accept</span> 4433
Using default temp DH parameters
ACCEPT
<span class="nt">-----BEGIN</span> SSL SESSION PARAMETERS-----
MIGDAgEBAgIDBAQCEwIEIMgh++wyAnXLISZyURB2+Ri9yzg2IkzQZioUBDQxqtjj
BDD+ACxTOfWiGktJAXTzaxG/3YsvhkxB0SQGbjZU9r5/PvLMrJ0M/KXQHZrwz3Am
wcWhBgIEZ0GQRKIEAgIcIKQGBAQBAAAArgcCBQC+0VG1swMCAR0<span class="o">=</span>
<span class="nt">-----END</span> SSL SESSION PARAMETERS-----
Shared ciphers:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:DHE-RSA-AES256-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES256-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES128-SHA:DHE-RSA-AES128-SHA:AES256-GCM-SHA384:AES128-GCM-SHA256:AES256-SHA256:AES128-SHA256:AES256-SHA:AES128-SHA
Signature Algorithms: ECDSA+SHA256:ECDSA+SHA384:ECDSA+SHA512:Ed25519:Ed448:ECDSA+SHA256:ECDSA+SHA384:ECDSA+SHA512:RSA-PSS+SHA256:RSA-PSS+SHA384:RSA-PSS+SHA512:RSA-PSS+SHA256:RSA-PSS+SHA384:RSA-PSS+SHA512:RSA+SHA256:RSA+SHA384:RSA+SHA512:ECDSA+SHA224:RSA+SHA224:DSA+SHA224:DSA+SHA256:DSA+SHA384:DSA+SHA512
Shared Signature Algorithms: ECDSA+SHA256:ECDSA+SHA384:ECDSA+SHA512:Ed25519:Ed448:ECDSA+SHA256:ECDSA+SHA384:ECDSA+SHA512:RSA-PSS+SHA256:RSA-PSS+SHA384:RSA-PSS+SHA512:RSA-PSS+SHA256:RSA-PSS+SHA384:RSA-PSS+SHA512:RSA+SHA256:RSA+SHA384:RSA+SHA512:ECDSA+SHA224:RSA+SHA224
Supported <span class="nb">groups</span>: x25519:secp256r1:x448:secp521r1:secp384r1:ffdhe2048:ffdhe3072:ffdhe4096:ffdhe6144:ffdhe8192
Shared <span class="nb">groups</span>: x25519:secp256r1:x448:secp521r1:secp384r1:ffdhe2048:ffdhe3072:ffdhe4096:ffdhe6144:ffdhe8192
CIPHER is TLS_AES_256_GCM_SHA384
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
</pre></td><td class="rouge-code"><pre>‚ùØ openssl s_client <span class="nt">-connect</span> localhost:4433 <span class="nt">-CAfile</span> rootCA.crt
Connecting to 127.0.0.1
CONNECTED<span class="o">(</span>00000009<span class="o">)</span>
Can<span class="s1">'t use SSL_get_servername
depth=1 C=AU, ST=Some-State, O=Internet Widgits Pty Ltd
verify return:1
depth=0 C=AU, ST=Some-State, O=Internet Widgits Pty Ltd
verify return:1
---
Certificate chain
 0 s:C=AU, ST=Some-State, O=Internet Widgits Pty Ltd
   i:C=AU, ST=Some-State, O=Internet Widgits Pty Ltd
   a:PKEY: rsaEncryption, 2048 (bit); sigalg: RSA-SHA256
   v:NotBefore: Nov 23 08:10:23 2024 GMT; NotAfter: Nov 23 08:10:23 2025 GMT
 1 s:C=AU, ST=Some-State, O=Internet Widgits Pty Ltd
   i:C=AU, ST=Some-State, O=Internet Widgits Pty Ltd
   a:PKEY: rsaEncryption, 2048 (bit); sigalg: RSA-SHA256
   v:NotBefore: Nov 23 08:09:36 2024 GMT; NotAfter: Nov 21 08:09:36 2034 GMT
---
Server certificate
-----BEGIN CERTIFICATE-----
MIIDWjCCAkKgAwIBAgIUWCSlOd3FwC1M523YmR3NJGIcrC4wDQYJKoZIhvcNAQEL
BQAwRTELMAkGA1UEBhMCQVUxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoM
GEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDAeFw0yNDExMjMwODEwMjNaFw0yNTEx
MjMwODEwMjNaMEUxCzAJBgNVBAYTAkFVMRMwEQYDVQQIDApTb21lLVN0YXRlMSEw
HwYDVQQKDBhJbnRlcm5ldCBXaWRnaXRzIFB0eSBMdGQwggEiMA0GCSqGSIb3DQEB
AQUAA4IBDwAwggEKAoIBAQClUK6+tWhKWumwAEYPNrk3Mi4Jy+gCrL4RjAVRsLaj
zbSNEfDKubsI1LE6v3w9P1a67OmmY0AXfPWh6rN9xKvJ9EP0HHLnKi48XUYfI+Eu
hhIuCdY0FYbYGcfGuqyHsYCUfi52NB3l4lUGexLGBnFtw0b/xgZclsJf2O9v9Bln
WXrRjx7SM+9gKafA0GJuLGGjH0S0d+uikirbZWduKctoj9jjJ9tGoF0a0XucyiFz
l3Ems2QD6wHS+vYyvSktVCLXamZdtJ+g69wvf+293BmjOtSZyK4ZnnSBFEk9tVYH
zRrPWTrJw8j4clNvbq9R18WE2q0Z3iz+YNMrOJKI89f3AgMBAAGjQjBAMB0GA1Ud
DgQWBBRLIkeIL8RofsaS1+ee4+920eF25DAfBgNVHSMEGDAWgBT54cF8S9EV5E0I
W21aNrPv3U8K4jANBgkqhkiG9w0BAQsFAAOCAQEAGTY1+3ijMJd1ObOC4Vau+uMI
KfLwFxzqFJ0w45+M0RKg9zow+aGnoWioAqdytVkXnQNFKqBrHJ6brXxy35LmCNRA
pGAF/SDZCGbiVQqPyK1hIkFrvEYzP9oCBFveCle2wVOD7zpbNDbpbSt5kC4c68sa
de5Lp0u4Pt547zennqPI7GyQCdB3bz7XiyyuoaEk6CRb8+uzOOIxvOdcWqu2IIDa
5aI/97W/JCveEKgDcbny8vpV/oZwm+AlxUmp5NS33z+OhW4XlPj9+9B1/LLiX/m5
7K8fdB0o+QM/ieDNwWe18bNe5jkQt0UArJFCHxUebVcYeSXHDk9sdb/stkGb/g==
-----END CERTIFICATE-----
subject=C=AU, ST=Some-State, O=Internet Widgits Pty Ltd
issuer=C=AU, ST=Some-State, O=Internet Widgits Pty Ltd
---
No client certificate CA names sent
Peer signing digest: SHA256
Peer signature type: RSA-PSS
Server Temp Key: X25519, 253 bits
---
SSL handshake has read 2302 bytes and written 382 bytes
Verification: OK
---
New, TLSv1.3, Cipher is TLS_AES_256_GCM_SHA384
Protocol: TLSv1.3
Server public key is 2048 bit
This TLS version forbids renegotiation.
Compression: NONE
Expansion: NONE
No ALPN negotiated
Early data was not sent
Verify return code: 0 (ok)
---
---
Post-Handshake New Session Ticket arrived:
SSL-Session:
    Protocol  : TLSv1.3
    Cipher    : TLS_AES_256_GCM_SHA384
    Session-ID: 76B8EBB15D24AA9A7A41DD6BC1CA6DF77D89F4458C6517A974B54DCA2E9D0AE0
    Session-ID-ctx: 
    Resumption PSK: ECB7546E2D711C3BA419C0F888AE2B39043BE65324E1C9E485F573D38F85B42E20AEBB2B0EBDD9B106B6BFABB283CC24
    PSK identity: None
    PSK identity hint: None
    SRP username: None
    TLS session ticket lifetime hint: 7200 (seconds)
    TLS session ticket:
    0000 - 08 72 9b 9c 71 22 2e 4a-04 4a a6 8d e9 51 b8 3e   .r..q".J.J...Q.&gt;
    0010 - 4b d4 de 72 53 55 2d 25-04 fa 2f 15 33 b9 46 1c   K..rSU-%../.3.F.
    0020 - 2d 16 13 4b 32 c2 b3 46-ff 16 76 c7 0e 28 ea 2d   -..K2..F..v..(.-
    0030 - 70 e3 95 80 bc dd af 40-e6 05 47 67 51 9e b1 0a   p......@..GgQ...
    0040 - 6b 6e a7 15 53 ba 07 8b-ec 92 3b d1 8c cc 83 77   kn..S.....;....w
    0050 - 5f 83 33 ae 10 7b f4 94-0c 25 a9 e3 e6 b1 bc d7   _.3..{...%......
    0060 - fa 33 5b 49 e3 b8 a4 d9-0a fb ef 16 a2 5b 75 b3   .3[I.........[u.
    0070 - 33 6e d4 bf ec d3 ab 2a-0f 50 fd 94 a1 37 e2 24   3n.....*.P...7.$
    0080 - 85 da 2a 7b f2 80 40 0c-6d a9 7d 4c e1 c6 d2 80   ..*{..@.m.}L....
    0090 - 9c 06 5f 36 76 04 11 61-67 df 74 7f e9 e6 27 cc   .._6v..ag.t...'</span><span class="nb">.</span>
    00a0 - 99 07 db ee 1e 1b a6 84-c8 37 87 87 01 40 45 <span class="nb">cd</span>   .........7...@E.
    00b0 - 90 6a 40 97 2b <span class="nb">df </span>17 ac-d5 da c3 5e 74 b5 2f ca   .j@.+......^t./.
    00c0 - bf 12 29 be a7 1d c2 af-16 54 a9 <span class="nb">df </span>40 1d 28 4d   ..<span class="o">)</span>......T..@.<span class="o">(</span>M

    Start Time: 1732350020
    Timeout   : 7200 <span class="o">(</span>sec<span class="o">)</span>
    Verify <span class="k">return </span>code: 0 <span class="o">(</span>ok<span class="o">)</span>
    Extended master secret: no
    Max Early Data: 0
<span class="nt">---</span>
<span class="nb">read </span>R BLOCK
<span class="nt">---</span>
Post-Handshake New Session Ticket arrived:
SSL-Session:
    Protocol  : TLSv1.3
    Cipher    : TLS_AES_256_GCM_SHA384
    Session-ID: F956D4DC78F7CEE8859EE8DE6B6A3D608E8283D08141CEEA9D98635F45F12B5B
    Session-ID-ctx: 
    Resumption PSK: FE002C5339F5A21A4B490174F36B11BFDD8B2F864C41D124066E3654F6BE7F3EF2CCAC9D0CFCA5D01D9AF0CF7026C1C5
    PSK identity: None
    PSK identity hint: None
    SRP username: None
    TLS session ticket lifetime hint: 7200 <span class="o">(</span>seconds<span class="o">)</span>
    TLS session ticket:
    0000 - 08 72 9b 9c 71 22 2e 4a-04 4a a6 8d e9 51 b8 3e   .r..q<span class="s2">".J.J...Q.&gt;
    0010 - db c6 5e 32 62 28 57 54-6a 95 e5 34 df 9a 6c f6   ..^2b(WTj..4..l.
    0020 - 7c 69 d5 82 d8 89 fd 77-7d 64 70 61 d7 bf ed 18   |i.....w}dpa....
    0030 - f2 6b 16 67 f7 4e 42 3a-84 13 7b 9a d7 09 9f a2   .k.g.NB:..{.....
    0040 - 17 79 e9 74 89 fb 1c 06-a8 a1 8e 91 eb e1 91 59   .y.t...........Y
    0050 - 1b b5 77 7a 51 8d 4c 55-98 88 da c9 5e 15 65 09   ..wzQ.LU....^.e.
    0060 - 37 20 9c b9 36 9b 9c de-2c 94 32 a5 34 21 17 2c   7 ..6...,.2.4!.,
    0070 - 1c e2 7b 76 fc f3 74 4d-d4 d0 6b e8 7a b9 83 07   ..{v..tM..k.z...
    0080 - 1a 28 d2 9c 66 96 09 a4-a5 57 30 5f b3 c1 67 b5   .(..f....W0_..g.
    0090 - f7 8d 9e ed 4a 0e 00 36-68 ac 0e 40 7b cd 13 38   ....J..6h..@{..8
    00a0 - 9a 70 96 f1 c6 b9 bf 3f-ff ee 19 8a fa 16 f9 d1   .p.....?........
    00b0 - 8b 74 18 2a ee 7a 23 44-3b 2b cc 79 f2 1f 06 04   .t.*.z#D;+.y....
    00c0 - 31 55 08 eb 52 34 ef 7a-4c ea 09 4c 8b 73 dd c2   1U..R4.zL..L.s..

    Start Time: 1732350020
    Timeout   : 7200 (sec)
    Verify return code: 0 (ok)
    Extended master secret: no
    Max Early Data: 0
---
read R BLOCK
</span></pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="option-c-lets-encrypt-free-certificate-authority">Option C: Let‚Äôs Encrypt free Certificate Authority</h3>

<blockquote class="prompt-info">
  <p>Let‚Äôs Encrypt is a free, automated, and open Certificate Authority (CA) that provides SSL/TLS certificates to secure websites using ACME protocol. It simplifies the process of obtaining, installing, and renewing certificates using automation tools like Certbot.</p>
</blockquote>

<h4 id="pros">Pros</h4>

<ul>
  <li>its free</li>
  <li>easy to automate without human intervention</li>
  <li>backend by nonprofit company</li>
  <li>trusted by all major browsers and devices</li>
</ul>

<h4 id="cons">Cons</h4>

<ul>
  <li>issued certs lifetime is only 90 days</li>
  <li>only domain validated certs are possible (no EV or OV)</li>
  <li>no warranty</li>
</ul>

<blockquote class="prompt-info">
  <p>What is ACME: Automatic Certificate Management Environment. It is a protocol designed to automate the process of issuing, renewing, and revoking SSL/TLS certificates. ACME eliminates the need for manual certificate management by allowing software to interact with a Certificate Authority (CA) directly.</p>
</blockquote>

<h5 id="validation-methods">Validation methods</h5>

<ul>
  <li>HTTP-01 Challenge: Place a specific file in a .well-known/acme-challenge/ directory on your server.</li>
  <li>DNS-01 Challenge: Add a TXT record to your domain‚Äôs DNS configuration.</li>
  <li>TLS-ALPN-01 Challenge: Requires the server to support ALPN (Application-Layer Protocol Negotiation) and respond to a challenge over HTTPS.</li>
</ul>

<h4 id="suggested-usage-with-dns-validation">Suggested usage with DNS validation</h4>

<p>I prefer using this method since it only requires that you delegate your domain ownership from the original domain registrar to CloudFlare and use the CloudFlare API with some automation to renew your certificate.</p>

<p>The process itself is quite simple:</p>

<ul>
  <li>ensure you have set the dns server at your dns registrar to cloudflare <a href="https://developers.cloudflare.com/dns/zone-setups/full-setup/setup/">LINK</a></li>
  <li>create cloudflare api token <a href="https://developers.cloudflare.com/fundamentals/api/get-started/create-token/">LINK</a></li>
</ul>

<blockquote class="prompt-tip">
  <p>After this you can start an example docker compose project which will retrieve ssl certs for your domain using your token
Use <a href="https://github.com/dtap001/example-webapp-with-traefik-and-ssl">this repository as example</a></p>
</blockquote>

<hr />

<h2 id="ssl--tls">SSL / TLS</h2>

<p>TLS, short for Transport Layer Security, and <a href="https://kinsta.com/knowledge/base/how-ssl-works/">SSL</a>, short for Secure Socket Layers, are both cryptographic protocols that encrypt data and authenticate a connection when moving data on the Internet.</p>

<blockquote class="prompt-tip">
  <p>Well, <strong>TLS is actually just a more recent version of SSL</strong></p>
</blockquote>

<ul>
  <li>SSL 1.0 ‚Äì never publicly released due to security issues.</li>
  <li>SSL 2.0 ‚Äì released in 1995. Deprecated in 2011. Has known security issues.</li>
  <li>SSL 3.0 ‚Äì released in 1996. Deprecated in 2015. Has known security issues.</li>
  <li>TLS 1.0 ‚Äì released in 1999 as an upgrade to SSL 3.0. Planned deprecation in 2020.</li>
  <li>TLS 1.1 ‚Äì released in 2006. Planned deprecation in 2020.</li>
  <li>TLS 1.2 ‚Äì released in 2008.</li>
  <li>TLS 1.3 ‚Äì released in 2018.</li>
</ul>

<blockquote class="prompt-info">
  <p><strong>Why do we calling the certs SSL cert?</strong>
The reason why most people still refer to them as SSL certificates is basically a branding issue. Most major certificate providers still refer to certificates as SSL certificates, which is why the naming convention persists.</p>
</blockquote>

<p>In reality, all the ‚ÄúSSL Certificates‚Äù that you see advertised are really <strong>SSL/TLS Certificates</strong></p>

<blockquote class="prompt-tip">
  <p>What is HTTP<strong>S</strong>?!
This is also where HTTPS comes in (HTTPS stands for ‚ÄúHTTP over SSL/TLS‚Äù).
What will be encrypted during a https request?
only the request part of the http</p>
</blockquote>

<h2 id="https-internals-the-tls-handshake">HTTPS internals the TLS handshake</h2>

<blockquote>
  <p>The TLS handshake is the process how the client (browser, curl etc..) and the server establish a seure communication over TLS protocol.</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre>Client                                  Server
  |      ClientHello                   |
  |-----------------------------------&gt;| <span class="o">(</span>Includes supported TLS versions, cipher suites, random value<span class="o">)</span>
  |                                    |
  |      ServerHello                   |
  |&lt;<span class="nt">-----------------------------------</span>| <span class="o">(</span>Includes chosen cipher suite, random value, server<span class="s1">'s public key)
  |                                    |
  |      Key Exchange (ECDHE)          |
  |&lt;-----------------------------------&gt;| (Both exchange keys to compute shared session key)
  |                                    |
  |      Finished                      |
  |&lt;-----------------------------------&gt;| (Both verify the handshake and secure the channel)
</span></pre></td></tr></tbody></table></code></pre></div></div>

<blockquote>
  <p>In a traditional TLS handshake process only the server proves its identity for the client with its certificate.</p>
</blockquote>

<p>You can debug this flow with:</p>

<ul>
  <li>openssl:</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl s_client <span class="nt">-connect</span> &lt;server&gt;:443 <span class="nt">-msg</span> <span class="nt">-debug</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>curl in verbose mode:</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>curl <span class="nt">-vvv</span> https://&lt;server&gt;
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>or even with ssh</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>ssh <span class="nt">-vvv</span> user@hostname
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="ssl-termination">SSL termination</h2>

<blockquote class="prompt-info">
  <p>SSL termination is a process of terminating the SSL/TLS connection on the edge of your infrastructure. This way helping the management of certificates since you don‚Äôt have to maintain them outside of your infrastructure‚Äôs secure context. Helps to debug and trace the interservice communication. Helps to easy the load pressure on servers since they don‚Äôt have to deal with encryption.  SSL termination is usually done in the main ingress for your services.</p>
</blockquote>

<h2 id="mutual-tls">Mutual TLS</h2>

<blockquote class="prompt-info">
  <p>It is an extension for TLS protocol which make possible that both parties authenticate to each other during the handshake process.</p>
</blockquote>

<p>mTLS handshake process:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre>Client                                  Server
  |      ClientHello                   |
  |-----------------------------------&gt;| <span class="o">(</span>Includes supported TLS versions, cipher suites, random value<span class="o">)</span>
  |                                    |
  |      ServerHello                   |
  |&lt;<span class="nt">-----------------------------------</span>| <span class="o">(</span>Includes chosen cipher suite, random value, server<span class="s1">'s public key)
  |                                    |
  |      Certificate (Server'</span>s cert<span class="o">)</span>    |
  |&lt;<span class="nt">-----------------------------------</span>| <span class="o">(</span>Server presents its certificate <span class="k">for </span>authentication<span class="o">)</span>
  |                                    |
  |      Key Exchange <span class="o">(</span>ECDHE<span class="o">)</span>          |
  |&lt;<span class="nt">-----------------------------------</span><span class="o">&gt;</span>| <span class="o">(</span>Both exchange keys to compute shared session key<span class="o">)</span>
  |                                    |
  |      CertificateRequest            |
  |&lt;<span class="nt">-----------------------------------</span>| <span class="o">(</span>Server requests client<span class="s1">'s certificate for authentication)
  |                                    |
  |      Certificate (Client'</span>s cert<span class="o">)</span>    |
  |-----------------------------------&gt;| <span class="o">(</span>Client presents its certificate <span class="k">for </span>authentication<span class="o">)</span>
  |                                    |
  |      Finished                      |
  |&lt;<span class="nt">-----------------------------------</span><span class="o">&gt;</span>| <span class="o">(</span>Both verify the handshake and secure the channel<span class="o">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="lets-try--it-out">Lets try  it out</h3>

<h4 id="ca">CA</h4>

<ul>
  <li>Create the CA key</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl genpkey <span class="nt">-algorithm</span> RSA <span class="nt">-out</span> ca.key <span class="nt">-aes256</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Create the CA cert</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl req <span class="nt">-key</span> ca.key <span class="nt">-new</span> <span class="nt">-x509</span> <span class="nt">-out</span> ca.crt
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Trust the new CA</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">sudo cp </span>ca.crt /usr/local/share/ca-certificates/
<span class="nb">sudo </span>update-ca-certificates
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="server">Server</h4>

<ul>
  <li>Create the server key</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl genpkey <span class="nt">-algorithm</span> RSA <span class="nt">-out</span> server.key
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Create CSR for the server cert</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl req <span class="nt">-key</span> server.key <span class="nt">-new</span> <span class="nt">-out</span> server.csr
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Create cert with csr and key for the server</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl x509 <span class="nt">-req</span> <span class="nt">-in</span> server.csr <span class="nt">-CA</span> ca.crt <span class="nt">-CAkey</span> ca.key <span class="nt">-CAcreateserial</span> <span class="nt">-out</span> server.crt <span class="nt">-days</span> 365
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="client">Client</h4>

<ul>
  <li>Create the client key</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl genpkey <span class="nt">-algorithm</span> RSA <span class="nt">-out</span> client.key
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Create the CSR for the client</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl req <span class="nt">-key</span> client.key <span class="nt">-new</span> <span class="nt">-out</span> client.csr
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Create cert with csr and key for the client</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl x509 <span class="nt">-req</span> <span class="nt">-in</span> client.csr <span class="nt">-CA</span> ca.crt <span class="nt">-CAkey</span> ca.key <span class="nt">-CAcreateserial</span> <span class="nt">-out</span> client.crt <span class="nt">-days</span> 365
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="try-it-out-1">Try it out</h4>

<ul>
  <li>Start the test server with openssl</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>openssl s_server <span class="nt">-key</span> server.key <span class="nt">-cert</span> server.crt <span class="nt">-CAfile</span> ca.crt <span class="nt">-Verify</span> 1 <span class="nt">-accept</span> 4433
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Test it with curl</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>curl <span class="nt">-vvv</span> <span class="nt">--cert</span> client.crt <span class="nt">--key</span> client.key <span class="nt">--cacert</span> ca.crt https://localhost:4433
</pre></td></tr></tbody></table></code></pre></div></div>

<p>You can see the connection is properly created with the client certs</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre></td><td class="rouge-code"><pre>‚ùØ curl <span class="nt">-vvv</span> <span class="nt">--cert</span> client.crt <span class="nt">--key</span> client.key <span class="nt">--cacert</span> ca.crt https://localhost:4433
<span class="k">*</span>   Trying 127.0.0.1:4433...
<span class="k">*</span> Connected to localhost <span class="o">(</span>127.0.0.1<span class="o">)</span> port 4433 <span class="o">(</span><span class="c">#0)</span>
<span class="k">*</span> ALPN, offering h2
<span class="k">*</span> ALPN, offering http/1.1
<span class="k">*</span>  CAfile: ca.crt
<span class="k">*</span>  CApath: /etc/ssl/certs
<span class="k">*</span> TLSv1.0 <span class="o">(</span>OUT<span class="o">)</span>, TLS header, Certificate Status <span class="o">(</span>22<span class="o">)</span>:
<span class="k">*</span> TLSv1.3 <span class="o">(</span>OUT<span class="o">)</span>, TLS handshake, Client hello <span class="o">(</span>1<span class="o">)</span>:
<span class="k">*</span> TLSv1.2 <span class="o">(</span>IN<span class="o">)</span>, TLS header, Certificate Status <span class="o">(</span>22<span class="o">)</span>:
<span class="k">*</span> TLSv1.3 <span class="o">(</span>IN<span class="o">)</span>, TLS handshake, Server hello <span class="o">(</span>2<span class="o">)</span>:
<span class="k">*</span> TLSv1.2 <span class="o">(</span>IN<span class="o">)</span>, TLS header, Finished <span class="o">(</span>20<span class="o">)</span>:
<span class="k">*</span> TLSv1.2 <span class="o">(</span>IN<span class="o">)</span>, TLS header, Supplemental data <span class="o">(</span>23<span class="o">)</span>:
<span class="k">*</span> TLSv1.3 <span class="o">(</span>IN<span class="o">)</span>, TLS handshake, Encrypted Extensions <span class="o">(</span>8<span class="o">)</span>:
<span class="k">*</span> TLSv1.2 <span class="o">(</span>IN<span class="o">)</span>, TLS header, Supplemental data <span class="o">(</span>23<span class="o">)</span>:
<span class="k">*</span> TLSv1.3 <span class="o">(</span>IN<span class="o">)</span>, TLS handshake, Request CERT <span class="o">(</span>13<span class="o">)</span>:
<span class="k">*</span> TLSv1.2 <span class="o">(</span>IN<span class="o">)</span>, TLS header, Supplemental data <span class="o">(</span>23<span class="o">)</span>:
<span class="k">*</span> TLSv1.3 <span class="o">(</span>IN<span class="o">)</span>, TLS handshake, Certificate <span class="o">(</span>11<span class="o">)</span>:
<span class="k">*</span> TLSv1.2 <span class="o">(</span>IN<span class="o">)</span>, TLS header, Supplemental data <span class="o">(</span>23<span class="o">)</span>:
<span class="k">*</span> TLSv1.3 <span class="o">(</span>IN<span class="o">)</span>, TLS handshake, CERT verify <span class="o">(</span>15<span class="o">)</span>:
<span class="k">*</span> TLSv1.2 <span class="o">(</span>IN<span class="o">)</span>, TLS header, Supplemental data <span class="o">(</span>23<span class="o">)</span>:
<span class="k">*</span> TLSv1.3 <span class="o">(</span>IN<span class="o">)</span>, TLS handshake, Finished <span class="o">(</span>20<span class="o">)</span>:
<span class="k">*</span> TLSv1.2 <span class="o">(</span>OUT<span class="o">)</span>, TLS header, Finished <span class="o">(</span>20<span class="o">)</span>:
<span class="k">*</span> TLSv1.3 <span class="o">(</span>OUT<span class="o">)</span>, TLS change cipher, Change cipher spec <span class="o">(</span>1<span class="o">)</span>:
<span class="k">*</span> TLSv1.2 <span class="o">(</span>OUT<span class="o">)</span>, TLS header, Supplemental data <span class="o">(</span>23<span class="o">)</span>:
<span class="k">*</span> TLSv1.3 <span class="o">(</span>OUT<span class="o">)</span>, TLS handshake, Certificate <span class="o">(</span>11<span class="o">)</span>:
<span class="k">*</span> TLSv1.2 <span class="o">(</span>OUT<span class="o">)</span>, TLS header, Supplemental data <span class="o">(</span>23<span class="o">)</span>:
<span class="k">*</span> TLSv1.3 <span class="o">(</span>OUT<span class="o">)</span>, TLS handshake, CERT verify <span class="o">(</span>15<span class="o">)</span>:
<span class="k">*</span> TLSv1.2 <span class="o">(</span>OUT<span class="o">)</span>, TLS header, Supplemental data <span class="o">(</span>23<span class="o">)</span>:
<span class="k">*</span> TLSv1.3 <span class="o">(</span>OUT<span class="o">)</span>, TLS handshake, Finished <span class="o">(</span>20<span class="o">)</span>:
<span class="k">*</span> SSL connection using TLSv1.3 / TLS_AES_256_GCM_SHA384
<span class="k">*</span> ALPN, server did not agree to a protocol
<span class="k">*</span> Server certificate:
<span class="k">*</span>  subject: <span class="nv">C</span><span class="o">=</span>AU<span class="p">;</span> <span class="nv">ST</span><span class="o">=</span>Some-State<span class="p">;</span> <span class="nv">O</span><span class="o">=</span>Internet Widgits Pty Ltd<span class="p">;</span> <span class="nv">CN</span><span class="o">=</span>localhost
<span class="k">*</span>  start <span class="nb">date</span>: Nov 23 12:06:50 2024 GMT
<span class="k">*</span>  expire <span class="nb">date</span>: Nov 23 12:06:50 2025 GMT
<span class="k">*</span>  common name: localhost <span class="o">(</span>matched<span class="o">)</span>
<span class="k">*</span>  issuer: <span class="nv">C</span><span class="o">=</span>AU<span class="p">;</span> <span class="nv">ST</span><span class="o">=</span>Some-State<span class="p">;</span> <span class="nv">O</span><span class="o">=</span>Internet Widgits Pty Ltd<span class="p">;</span> <span class="nv">CN</span><span class="o">=</span>localhost
<span class="k">*</span>  SSL certificate verify ok.
<span class="k">*</span> TLSv1.2 <span class="o">(</span>OUT<span class="o">)</span>, TLS header, Supplemental data <span class="o">(</span>23<span class="o">)</span>:
<span class="o">&gt;</span> GET / HTTP/1.1
<span class="o">&gt;</span> Host: localhost:4433
<span class="o">&gt;</span> User-Agent: curl/7.81.0
<span class="o">&gt;</span> Accept: <span class="k">*</span>/<span class="k">*</span>
<span class="o">&gt;</span> 
<span class="k">*</span> TLSv1.2 <span class="o">(</span>IN<span class="o">)</span>, TLS header, Supplemental data <span class="o">(</span>23<span class="o">)</span>:
<span class="k">*</span> TLSv1.3 <span class="o">(</span>IN<span class="o">)</span>, TLS handshake, Newsession Ticket <span class="o">(</span>4<span class="o">)</span>:
<span class="k">*</span> TLSv1.2 <span class="o">(</span>IN<span class="o">)</span>, TLS header, Supplemental data <span class="o">(</span>23<span class="o">)</span>:
<span class="k">*</span> TLSv1.3 <span class="o">(</span>IN<span class="o">)</span>, TLS handshake, Newsession Ticket <span class="o">(</span>4<span class="o">)</span>:
</pre></td></tr></tbody></table></code></pre></div></div>

<p>However when you try it without client cert it fails:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre></td><td class="rouge-code"><pre>curl <span class="nt">-vvv</span>  https://localhost:4433
<span class="k">*</span>   Trying 127.0.0.1:4433...
<span class="k">*</span> Connected to localhost <span class="o">(</span>127.0.0.1<span class="o">)</span> port 4433 <span class="o">(</span><span class="c">#0)</span>
<span class="k">*</span> ALPN, offering h2
<span class="k">*</span> ALPN, offering http/1.1
<span class="k">*</span>  CAfile: /etc/ssl/certs/ca-certificates.crt
<span class="k">*</span>  CApath: /etc/ssl/certs
<span class="k">*</span> TLSv1.0 <span class="o">(</span>OUT<span class="o">)</span>, TLS header, Certificate Status <span class="o">(</span>22<span class="o">)</span>:
<span class="k">*</span> TLSv1.3 <span class="o">(</span>OUT<span class="o">)</span>, TLS handshake, Client hello <span class="o">(</span>1<span class="o">)</span>:
<span class="k">*</span> TLSv1.2 <span class="o">(</span>IN<span class="o">)</span>, TLS header, Certificate Status <span class="o">(</span>22<span class="o">)</span>:
<span class="k">*</span> TLSv1.3 <span class="o">(</span>IN<span class="o">)</span>, TLS handshake, Server hello <span class="o">(</span>2<span class="o">)</span>:
<span class="k">*</span> TLSv1.2 <span class="o">(</span>IN<span class="o">)</span>, TLS header, Finished <span class="o">(</span>20<span class="o">)</span>:
<span class="k">*</span> TLSv1.2 <span class="o">(</span>IN<span class="o">)</span>, TLS header, Supplemental data <span class="o">(</span>23<span class="o">)</span>:
<span class="k">*</span> TLSv1.3 <span class="o">(</span>IN<span class="o">)</span>, TLS handshake, Encrypted Extensions <span class="o">(</span>8<span class="o">)</span>:
<span class="k">*</span> TLSv1.2 <span class="o">(</span>IN<span class="o">)</span>, TLS header, Supplemental data <span class="o">(</span>23<span class="o">)</span>:
<span class="k">*</span> TLSv1.3 <span class="o">(</span>IN<span class="o">)</span>, TLS handshake, Request CERT <span class="o">(</span>13<span class="o">)</span>:
<span class="k">*</span> TLSv1.2 <span class="o">(</span>IN<span class="o">)</span>, TLS header, Supplemental data <span class="o">(</span>23<span class="o">)</span>:
<span class="k">*</span> TLSv1.3 <span class="o">(</span>IN<span class="o">)</span>, TLS handshake, Certificate <span class="o">(</span>11<span class="o">)</span>:
<span class="k">*</span> TLSv1.2 <span class="o">(</span>IN<span class="o">)</span>, TLS header, Supplemental data <span class="o">(</span>23<span class="o">)</span>:
<span class="k">*</span> TLSv1.3 <span class="o">(</span>IN<span class="o">)</span>, TLS handshake, CERT verify <span class="o">(</span>15<span class="o">)</span>:
<span class="k">*</span> TLSv1.2 <span class="o">(</span>IN<span class="o">)</span>, TLS header, Supplemental data <span class="o">(</span>23<span class="o">)</span>:
<span class="k">*</span> TLSv1.3 <span class="o">(</span>IN<span class="o">)</span>, TLS handshake, Finished <span class="o">(</span>20<span class="o">)</span>:
<span class="k">*</span> TLSv1.2 <span class="o">(</span>OUT<span class="o">)</span>, TLS header, Finished <span class="o">(</span>20<span class="o">)</span>:
<span class="k">*</span> TLSv1.3 <span class="o">(</span>OUT<span class="o">)</span>, TLS change cipher, Change cipher spec <span class="o">(</span>1<span class="o">)</span>:
<span class="k">*</span> TLSv1.2 <span class="o">(</span>OUT<span class="o">)</span>, TLS header, Supplemental data <span class="o">(</span>23<span class="o">)</span>:
<span class="k">*</span> TLSv1.3 <span class="o">(</span>OUT<span class="o">)</span>, TLS handshake, Certificate <span class="o">(</span>11<span class="o">)</span>:
<span class="k">*</span> TLSv1.2 <span class="o">(</span>OUT<span class="o">)</span>, TLS header, Supplemental data <span class="o">(</span>23<span class="o">)</span>:
<span class="k">*</span> TLSv1.3 <span class="o">(</span>OUT<span class="o">)</span>, TLS handshake, Finished <span class="o">(</span>20<span class="o">)</span>:
<span class="k">*</span> SSL connection using TLSv1.3 / TLS_AES_256_GCM_SHA384
<span class="k">*</span> ALPN, server did not agree to a protocol
<span class="k">*</span> Server certificate:
<span class="k">*</span>  subject: <span class="nv">C</span><span class="o">=</span>AU<span class="p">;</span> <span class="nv">ST</span><span class="o">=</span>Some-State<span class="p">;</span> <span class="nv">O</span><span class="o">=</span>Internet Widgits Pty Ltd<span class="p">;</span> <span class="nv">CN</span><span class="o">=</span>localhost
<span class="k">*</span>  start <span class="nb">date</span>: Nov 23 12:06:50 2024 GMT
<span class="k">*</span>  expire <span class="nb">date</span>: Nov 23 12:06:50 2025 GMT
<span class="k">*</span>  common name: localhost <span class="o">(</span>matched<span class="o">)</span>
<span class="k">*</span>  issuer: <span class="nv">C</span><span class="o">=</span>AU<span class="p">;</span> <span class="nv">ST</span><span class="o">=</span>Some-State<span class="p">;</span> <span class="nv">O</span><span class="o">=</span>Internet Widgits Pty Ltd<span class="p">;</span> <span class="nv">CN</span><span class="o">=</span>localhost
<span class="k">*</span>  SSL certificate verify ok.
<span class="k">*</span> TLSv1.2 <span class="o">(</span>OUT<span class="o">)</span>, TLS header, Supplemental data <span class="o">(</span>23<span class="o">)</span>:
<span class="o">&gt;</span> GET / HTTP/1.1
<span class="o">&gt;</span> Host: localhost:4433
<span class="o">&gt;</span> User-Agent: curl/7.81.0
<span class="o">&gt;</span> Accept: <span class="k">*</span>/<span class="k">*</span>
<span class="o">&gt;</span> 
<span class="k">*</span> TLSv1.2 <span class="o">(</span>IN<span class="o">)</span>, TLS header, Supplemental data <span class="o">(</span>23<span class="o">)</span>:
<span class="k">*</span> TLSv1.3 <span class="o">(</span>IN<span class="o">)</span>, TLS alert, unknown <span class="o">(</span>628<span class="o">)</span>:
<span class="k">*</span> OpenSSL SSL_read: error:0A00045C:SSL routines::tlsv13 alert certificate required, errno 0
<span class="k">*</span> Closing connection 0
curl: <span class="o">(</span>56<span class="o">)</span> OpenSSL SSL_read: error:0A00045C:SSL routines::tlsv13 alert certificate required, errno 0
</pre></td></tr></tbody></table></code></pre></div></div>]]></content><author><name></name></author><category term="security" /><category term="webdev" /><summary type="html"><![CDATA[This is my humble summary regarding every important aspect of the certificates that a developer likely will encounter. I will update this article as I learn more about this topic. Every feedback is welcomed and appreciated üôèüèª]]></summary></entry></feed>